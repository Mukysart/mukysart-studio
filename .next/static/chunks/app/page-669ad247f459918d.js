(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{874:(e,t,a)=>{"use strict";a.d(t,{default:()=>v});var s=a(3424),n=a(3884),r=a(6418),i=a(6447),o=a(9257),l=a(9793);function c(e){let{grad:t,id:a}=e;return"linear"===t.type?(0,s.jsx)("linearGradient",{id:a,gradientTransform:"rotate(".concat(t.angle,", 0.5, 0.5)"),children:t.stops.map(e=>(0,s.jsx)("stop",{offset:"".concat(e.position,"%"),stopColor:e.color},e.id))}):"radial"===t.type?(0,s.jsx)("radialGradient",{id:a,gradientUnits:"objectBoundingBox",cx:"0.5",cy:"0.5",r:"0.5",fx:"0.5",fy:"0.5",spreadMethod:"pad",children:t.stops.map(e=>(0,s.jsx)("stop",{offset:"".concat(e.position,"%"),stopColor:e.color},e.id))}):null}function d(e){var t,a;let{layer:i}=e,{project:o}=(0,r.h)(),l=(0,n.useRef)(null);i.id;let d="solid"===(t=i.color).type?"custom"===t.mode?t.value:o.colors[t.value]||"#000000":"transparent",h="shadow-".concat(i.id),u="outline-".concat(i.id),p="text-grad-".concat(i.id);if(i.font.curve&&0!==i.font.curve.amount){let{width:e,height:t}=i.transform,a=i.font.curve.amount,n="M 0,".concat(t/2," Q ").concat(e/2,",").concat(t/2+-(.75*a)/100*t," ").concat(e,",").concat(t/2),r="left"===i.font.align?"start":"right"===i.font.align?"end":"middle",o="left"===i.font.align?"0%":"right"===i.font.align?"100%":"50%",l=!!i.font.shadow,m=!!i.font.outline,x="";m&&(x+="url(#".concat(u,") ")),l&&(x+="url(#".concat(h,")"));let f="solid"===i.color.type?d:"url(#".concat(p,")");return(0,s.jsxs)("svg",{width:"100%",height:"100%",viewBox:"0 0 ".concat(e," ").concat(t),style:{overflow:"visible"},children:[(0,s.jsxs)("defs",{children:[(0,s.jsx)("path",{id:"curve-path-".concat(i.id),d:n,fill:"transparent",stroke:"transparent"}),"solid"!==i.color.type&&(0,s.jsx)(c,{grad:i.color,id:p}),l&&(0,s.jsx)("filter",{id:h,x:"-50%",y:"-50%",width:"200%",height:"200%",children:(0,s.jsx)("feDropShadow",{dx:i.font.shadow.offsetX,dy:i.font.shadow.offsetY,stdDeviation:i.font.shadow.blur/2,floodColor:i.font.shadow.color})}),m&&(0,s.jsxs)("filter",{id:u,x:"-50%",y:"-50%",width:"200%",height:"200%",children:[(0,s.jsx)("feMorphology",{operator:"dilate",radius:i.font.outline.width,in:"SourceAlpha",result:"thickened"}),(0,s.jsx)("feFlood",{floodColor:i.font.outline.color,result:"colorized"}),(0,s.jsx)("feComposite",{in:"colorized",in2:"thickened",operator:"in",result:"outline"}),(0,s.jsxs)("feMerge",{children:[(0,s.jsx)("feMergeNode",{in:"outline"}),(0,s.jsx)("feMergeNode",{in:"SourceGraphic"})]})]})]}),(0,s.jsx)("text",{style:{fontFamily:i.font.family,fontSize:i.font.size,fontWeight:i.font.weight,letterSpacing:i.font.letterSpacing,fontStyle:i.font.style,textDecoration:i.font.decoration},fill:f,textAnchor:r,filter:x.trim()||void 0,children:(0,s.jsx)("textPath",{href:"#curve-path-".concat(i.id),startOffset:o,children:i.content})})]})}let m="left"===i.font.align?"flex-start":"right"===i.font.align?"flex-end":"center",x=i.font.shadow?"".concat(i.font.shadow.offsetX,"px ").concat(i.font.shadow.offsetY,"px ").concat(i.font.shadow.blur,"px ").concat(i.font.shadow.color):"none",f=i.font.outline?"".concat(i.font.outline.width,"px ").concat(i.font.outline.color):"none",g={padding:i.padding?"".concat(i.padding,"px"):void 0,fontSize:i.font.size,fontWeight:i.font.weight,fontFamily:i.font.family,lineHeight:i.font.lineHeight,letterSpacing:i.font.letterSpacing,textAlign:i.font.align,color:d,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:m,whiteSpace:"pre-wrap",wordBreak:"break-word",fontStyle:i.font.style,textDecoration:i.font.decoration,textShadow:x,WebkitTextStroke:f};if("solid"!==i.color.type){g.background="linear"===(a=i.color).type?"linear-gradient(".concat(a.angle,"deg, ").concat(a.stops.map(e=>"".concat(e.color," ").concat(e.position,"%")).join(", "),")"):"radial"===a.type?"radial-gradient(".concat(a.shape,", ").concat(a.stops.map(e=>"".concat(e.color," ").concat(e.position,"%")).join(", "),")"):"none",g.color="transparent",g.WebkitBackgroundClip="text",g.backgroundClip="text"}return(0,s.jsx)("div",{ref:l,style:g,contentEditable:!1,children:i.content})}var h=a(3966);function u(e){let{grad:t,id:a}=e;return"linear"===t.type?(0,s.jsx)("linearGradient",{id:a,gradientTransform:"rotate(".concat(t.angle,", 0.5, 0.5)"),children:t.stops.map(e=>(0,s.jsx)("stop",{offset:"".concat(e.position,"%"),stopColor:e.color},e.id))}):"radial"===t.type?(0,s.jsx)("radialGradient",{id:a,gradientUnits:"objectBoundingBox",cx:"0.5",cy:"0.5",r:"0.5",fx:"0.5",fy:"0.5",spreadMethod:"pad",children:t.stops.map(e=>(0,s.jsx)("stop",{offset:"".concat(e.position,"%"),stopColor:e.color},e.id))}):null}function p(e){var t;let{layer:a,onPathMouseDown:n,isCropping:i}=e,{project:o}=(0,r.h)(),{shape:c}=a,d=a.id,p="clip-path-".concat(d),m="shadow-".concat(d),x="fill-gradient-".concat(d),f="stroke-gradient-".concat(d),g=e=>"solid"===e.type?"custom"===e.mode?e.value:o.colors[e.value]||"#000000":"none",v={d:(0,l.bP)(a)},y="path"===c.primitive?n:void 0,j="solid"===c.fill.type?g(c.fill):"url(#".concat(x,")"),w=(null==(t=c.stroke)?void 0:t.color.type)==="solid"?g(c.stroke.color):"url(#".concat(f,")"),b=c.fillImage;return(0,s.jsxs)("div",{style:{width:"100%",height:"100%",position:"relative"},className:"group transition-opacity group-hover:opacity-80",children:[(0,s.jsxs)("svg",{width:"100%",height:"100%",style:{position:"absolute",top:0,left:0,overflow:"visible"},children:[(0,s.jsxs)("defs",{children:[c.shadow&&(0,s.jsx)("filter",{id:m,x:"-50%",y:"-50%",width:"200%",height:"200%",children:(0,s.jsx)("feDropShadow",{dx:c.shadow.offsetX,dy:c.shadow.offsetY,stdDeviation:c.shadow.blur/2,floodColor:c.shadow.color})}),!1!==c.isClosed&&(0,s.jsx)("clipPath",{id:p,children:(0,s.jsx)("path",{...v})}),"solid"!==c.fill.type&&(0,s.jsx)(u,{grad:c.fill,id:x}),c.stroke&&"solid"!==c.stroke.color.type&&(0,s.jsx)(u,{grad:c.stroke.color,id:f})]}),(0,s.jsx)("path",{...v,fill:!1===c.isClosed?"none":j,filter:c.shadow?"url(#".concat(m,")"):"none",onMouseDown:y,style:{pointerEvents:"all",cursor:"path"===c.primitive?"copy":void 0}}),c.stroke&&(0,s.jsx)("path",{...v,fill:"none",stroke:w,strokeWidth:c.stroke.width,strokeDasharray:c.stroke.dash,style:{pointerEvents:"none"}})]}),(null==b?void 0:b.src)&&!1!==c.isClosed&&(0,s.jsx)("div",{style:{width:"100%",height:"100%",clipPath:"url(#".concat(p,")"),pointerEvents:"none",overflow:"hidden"},children:(0,s.jsx)(h.default,{src:b.src,alt:a.name,fill:!0,style:{objectFit:b.fit,objectPosition:"".concat(b.pan.x,"% ").concat(b.pan.y,"%"),transform:"scale(".concat(b.scale||1,")")},className:"pointer-events-none",draggable:!1})}),i&&b&&(0,s.jsx)("div",{className:"absolute inset-0 bg-black/30 pointer-events-none",style:{clipPath:"url(#".concat(p,")")}})]})}function m(e){let{layer:t,isCropping:a}=e,[r,i]=(0,n.useState)(t.src),o=(0,n.useRef)(null);(0,n.useEffect)(()=>{if(!t.chromaKey.enabled||!t.src){r!==t.src&&i(t.src);return}let e=new window.Image;e.crossOrigin="Anonymous",e.src=t.src,e.onload=()=>{var a;let s=null!=(a=o.current)?a:document.createElement("canvas");o.current||(o.current=s),s.width=e.naturalWidth,s.height=e.naturalHeight;let n=s.getContext("2d");if(n){n.drawImage(e,0,0);try{let e=n.getImageData(0,0,s.width,s.height),a=e.data,r=function(e){let t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}(t.chromaKey.color);if(!r)return;let{r:o,g:l,b:c}=r,d=255*t.chromaKey.tolerance*1.732,h=t.chromaKey.feather*d;for(let e=0;e<a.length;e+=4){let s=a[e],n=a[e+1],r=a[e+2],i=Math.sqrt(Math.pow(s-o,2)+Math.pow(n-l,2)+Math.pow(r-c,2)),u=255;i<d&&(u=h>0&&h<d?Math.floor(Math.min(255,(i-(d-h))/h*255)):0),a[e+3]=t.chromaKey.invert?255-u:u}n.putImageData(e,0,0),i(s.toDataURL())}catch(e){console.error("Chroma key failed, likely due to CORS policy. Fallback to original image.",e),i(t.src)}}},e.onerror=()=>{console.error("Failed to load image for chroma keying."),i(t.src)}},[t.src,t.chromaKey]);let l={clipPath:"inset(".concat(t.crop.top,"% ").concat(t.crop.right,"% ").concat(t.crop.bottom,"% ").concat(t.crop.left,"%)")},c={filter:t.shadow?"drop-shadow(".concat(t.shadow.offsetX,"px ").concat(t.shadow.offsetY,"px ").concat(t.shadow.blur,"px ").concat(t.shadow.color,")"):"none"};return(0,s.jsxs)("div",{style:{width:"100%",height:"100%",position:"relative",overflow:"hidden",...c},children:[(0,s.jsx)("div",{style:{width:"100%",height:"100%",...l},children:(0,s.jsx)("img",{src:r,alt:t.name,style:{width:"100%",height:"100%",objectFit:t.fit,objectPosition:"".concat(t.pan.x,"% ").concat(t.pan.y,"%")},className:"pointer-events-none",draggable:!1})}),a&&(0,s.jsx)("div",{className:"absolute inset-0 bg-black/30 pointer-events-none"})]})}function x(e){var t,a;let{layer:i,onMouseDown:o,onNodeMouseDown:l,onPathMouseDown:c,action:h,deleteNode:u}=e,{project:x,eyedropper:f}=(0,r.h)(),g=x.selectedLayers.includes(i.id),v=!!h,y=(null==h?void 0:h.type)==="move"&&(null==(t=h.initialLayerData)?void 0:t.has(i.id)),j="node"===x.activeTool&&g,w=x.croppingLayerId===i.id,b=1===x.selectedLayers.length&&"select"===x.activeTool,N=null==f?void 0:f.isActive,C=i.groupId?x.groups.find(e=>e.id===i.groupId):null,k=i.visible&&(!C||C.visible),I=i.locked||!!C&&C.locked,M={position:"absolute",left:i.transform.x,top:i.transform.y,width:i.transform.width,height:i.transform.height,transform:"rotate(".concat(i.transform.rotation,"deg)"),opacity:i.transform.opacity,visibility:k?"visible":"hidden",zIndex:i.zIndex,cursor:N?"crosshair":w?"move":I?"not-allowed":y?"grabbing":"select"===x.activeTool?"grab":"crosshair",userSelect:"none",boxShadow:y?"0 10px 20px rgba(0,0,0,0.19), 0 6px 6px rgba(0,0,0,0.23)":void 0,filter:i.transform.blur?"blur(".concat(i.transform.blur,"px)"):void 0};return(0,s.jsxs)("div",{style:M,className:"group",onMouseDown:e=>{N||o(e,i.id)},children:["text"===i.type&&(0,s.jsx)(d,{layer:i}),"shape"===i.type&&(0,s.jsx)(p,{layer:i,onPathMouseDown:e=>{c(e,i.id)},isCropping:w}),"image"===i.type&&(0,s.jsx)(m,{layer:i,isCropping:w}),j&&"shape"===i.type&&(null==(a=i.shape.points)?void 0:a.map(e=>{let t=e.x/100*i.transform.width,a=e.y/100*i.transform.height,r=e.handles.in.x/100*i.transform.width,o=e.handles.in.y/100*i.transform.height,c=e.handles.out.x/100*i.transform.width,d=e.handles.out.y/100*i.transform.height,h={position:"absolute",width:"".concat(24,"px"),height:"".concat(24,"px"),backgroundColor:"hsl(var(--background))",borderRadius:"50%",border:"1px solid hsl(var(--ring))",cursor:"move",pointerEvents:"auto"};return(0,s.jsxs)(n.Fragment,{children:[(0,s.jsxs)("svg",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"visible",pointerEvents:"none"},children:[(0,s.jsx)("line",{x1:t,y1:a,x2:r,y2:o,stroke:"hsl(var(--ring))",strokeWidth:"1"}),(0,s.jsx)("line",{x1:t,y1:a,x2:c,y2:d,stroke:"hsl(var(--ring))",strokeWidth:"1"})]}),(0,s.jsx)("div",{style:{...h,left:r-12,top:o-12},onMouseDown:t=>l(t,i.id,e.id,"move-handle","in"),className:"transition-transform hover:scale-125"}),(0,s.jsx)("div",{style:{...h,left:c-12,top:d-12},onMouseDown:t=>l(t,i.id,e.id,"move-handle","out"),className:"transition-transform hover:scale-125"}),(0,s.jsx)("div",{style:{...h,width:"".concat(32,"px"),height:"".concat(32,"px"),left:t-16,top:a-16,backgroundColor:"hsl(var(--ring))"},onMouseDown:t=>l(t,i.id,e.id,"move-node"),className:"transition-transform hover:scale-125"}),(0,s.jsx)("div",{style:{position:"absolute",left:t-16-24,top:a-16,width:20,height:20,backgroundColor:"hsl(var(--destructive))",color:"hsl(var(--destructive-foreground))",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontWeight:"bold",fontSize:14,zIndex:10,pointerEvents:"auto"},onMouseDown:t=>{t.stopPropagation(),t.preventDefault(),u(i.id,e.id)},className:"transition-all duration-200 ease-in-out hover:bg-red-600 hover:scale-110",children:"\xd7"})]},e.id)})),g&&!b&&!v&&!j&&!w&&(0,s.jsx)("div",{className:"absolute inset-0 border-2 border-ring pointer-events-none group-hover:border-[3px] transition-all"}),!g&&"select"===x.activeTool&&!v&&(0,s.jsx)("div",{className:"absolute inset-0 border-2 border-transparent group-hover:border-ring/50 pointer-events-none rounded-sm"})]})}var f=a(9947),g=a.n(f);function v(){let{project:e,setProject:t,setActiveTool:a,duplicateLayers:c,eyedropper:d,finishEyedropper:h,setEyedropperPreview:u,toast:p,setProjectLive:m,commitHistory:f}=(0,r.h)(),{width:v,height:y,background:j}=e.canvas,[w,b]=(0,n.useState)(null),[N,C]=(0,n.useState)(null),k=(0,n.useRef)(null),I=(0,n.useRef)(),M=(0,n.useRef)({x:0,y:0}),[z,A]=(0,n.useState)(null),[S,L]=(0,n.useState)({horizontal:[],vertical:[]}),E=(0,n.useRef)(null);(0,n.useLayoutEffect)(()=>{t(e=>({...e,zoomAction:"fit"}))},[t]),(0,n.useEffect)(()=>{if("fit"===e.zoomAction){var a,s,n;let r=null==(n=k.current)||null==(s=n.parentElement)||null==(a=s.parentElement)?void 0:a.parentElement;if(!r)return;let i=getComputedStyle(r),o=parseFloat(i.paddingLeft)+parseFloat(i.paddingRight),l=parseFloat(i.paddingTop)+parseFloat(i.paddingBottom),c=r.clientWidth-o,d=r.clientHeight-l,{width:h,height:u}=e.canvas,p=.9*Math.min(c/h,d/u);t(e=>({...e,zoom:p,zoomAction:null}))}},[e.zoomAction,e.canvas.width,e.canvas.height,t]),(0,n.useEffect)(()=>{("select"===e.activeTool||0===e.selectedLayers.length)&&C(null)},[e.activeTool,e.selectedLayers]);let D=(0,n.useCallback)((e,a)=>{t(t=>{let s=t.layers.map(t=>{if(t.id===e&&"shape"===t.type){if(!t.shape.points||t.shape.points.length<=3)return t;let e=t.shape.points.filter(e=>e.id!==a);return{...t,shape:{...t.shape,points:e}}}return t});return{...t,layers:s}}),C(null)},[t]);(0,n.useEffect)(()=>{let a=a=>{if("node"===e.activeTool&&N&&("Backspace"===a.key||"Delete"===a.key)){a.preventDefault(),D(N.layerId,N.pointId);return}let s=a.target;!("INPUT"===s.tagName||"TEXTAREA"===s.tagName||s.isContentEditable)&&e.selectedLayers.length>0&&("Backspace"===a.key||"Delete"===a.key?(a.preventDefault(),t(e=>({...e,layers:e.layers.filter(t=>!e.selectedLayers.includes(t.id)),selectedLayers:[]}))):(a.ctrlKey||a.metaKey)&&"d"===a.key&&(a.preventDefault(),c(e.selectedLayers)))};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[N,e.activeTool,e.selectedLayers,D,t,c]),(0,n.useEffect)(()=>{if("node"===e.activeTool&&1===e.selectedLayers.length){let a=e.selectedLayers[0];t(e=>{let t=!1,s=e.layers.map(e=>{if(e.id===a&&"shape"===e.type&&"path"!==e.shape.primitive){let a=(0,l.qw)(e);if(a!==e)return t=!0,a}return e});return t?{...e,layers:s}:e})}},[e.activeTool,e.selectedLayers,t]);let T=(0,n.useCallback)((t,a,s)=>{if(t.stopPropagation(),t.preventDefault(),0===e.selectedLayers.length)return;E.current=e;let n=new Map;e.layers.forEach(t=>{if(e.selectedLayers.includes(t.id)){let e={transform:{...t.transform}};"text"===t.type&&"resize"===a&&(e.initialFontSize=t.font.size),"image"===t.type&&(e.pan=t.pan,e.crop=t.crop),n.set(t.id,e)}}),b({type:a,startX:t.clientX,startY:t.clientY,initialLayerData:n,handle:s,shiftKey:t.shiftKey})},[e]),R=(0,n.useCallback)((e,a)=>{t(t=>{let s=t.layers.map(t=>{if(t.id===e&&"shape"===t.type&&t.shape.points){let e=t.shape.points.map(e=>{if(e.id===a){let t="corner"===e.type?"curve":"corner",a=e.handles;return"corner"===t?a={in:{x:e.x,y:e.y},out:{x:e.x,y:e.y}}:e.handles.in.x===e.x&&e.handles.in.y===e.y&&e.handles.out.x===e.x&&e.handles.out.y===e.y&&(a={in:{x:e.x-15,y:e.y},out:{x:e.x+15,y:e.y}}),{...e,type:t,handles:a}}return e});return{...t,shape:{...t.shape,points:e}}}return t});return{...t,layers:s}})},[t]),P=(0,n.useCallback)((t,a,s,n,r)=>{t.stopPropagation(),t.preventDefault();let i=e.layers.find(e=>e.id===a);i&&i.shape.points&&(C({layerId:a,pointId:s}),b({type:n,startX:t.clientX,startY:t.clientY,shiftKey:t.shiftKey,layerId:a,pointId:s,handleType:r,initialPoints:JSON.parse(JSON.stringify(i.shape.points))}))},[e,b]),J=(0,n.useCallback)((t,a)=>{t.stopPropagation(),E.current=e;let s=e.canvas.guides.items.find(e=>e.id===a);s&&b({type:"move-guide",startX:t.clientX,startY:t.clientY,shiftKey:t.shiftKey,guideId:a,initialGuidePosition:s.position})},[e.canvas.guides.items,e]);(0,n.useEffect)(()=>{let a=e=>{M.current={x:e.clientX,y:e.clientY},w&&(I.current&&cancelAnimationFrame(I.current),I.current=requestAnimationFrame(()=>{let e=M.current.x-w.startX,a=M.current.y-w.startY;(["move","resize","rotate"].includes(w.type)?m:t)(t=>{if("move-guide"===w.type&&w.guideId){let s=t.canvas.guides.items.find(e=>e.id===w.guideId);if(!s||void 0===w.initialGuidePosition)return t;let n="horizontal"===s.orientation?a:e,r=w.initialGuidePosition+n/t.zoom;r="horizontal"===s.orientation?Math.max(0,Math.min(r,t.canvas.height)):Math.max(0,Math.min(r,t.canvas.width));let i=t.canvas.guides.items.map(e=>e.id===w.guideId?{...e,position:r}:e);return{...t,canvas:{...t.canvas,guides:{...t.canvas.guides,items:i}}}}if("move-node"===w.type&&w.layerId&&w.pointId&&w.initialPoints){let s=t.layers.map(s=>{if(s.id!==w.layerId)return s;let n=s.shape.points.findIndex(e=>e.id===w.pointId);if(-1===n)return s;let r=w.initialPoints[n],i=e/t.zoom/s.transform.width*100,o=a/t.zoom/s.transform.height*100,l=[...s.shape.points],c={...l[n]};c.x=r.x+i,c.y=r.y+o;let d=c.x-r.x,h=c.y-r.y;return c.handles.in.x=r.handles.in.x+d,c.handles.in.y=r.handles.in.y+h,c.handles.out.x=r.handles.out.x+d,c.handles.out.y=r.handles.out.y+h,l[n]=c,{...s,shape:{...s.shape,points:l}}});return{...t,layers:s}}if("move-handle"===w.type&&w.layerId&&w.pointId&&w.initialPoints&&w.handleType){let s=t.layers.map(s=>{if(s.id!==w.layerId)return s;let n=s.shape.points.findIndex(e=>e.id===w.pointId);if(-1===n)return s;let r=w.initialPoints[n],i=e/t.zoom/s.transform.width*100,o=a/t.zoom/s.transform.height*100,l=JSON.parse(JSON.stringify(s.shape.points)),c=l[n],d=w.handleType,h="in"===d?"out":"in";if(c.handles[d].x=r.handles[d].x+i,c.handles[d].y=r.handles[d].y+o,"curve"===c.type&&!w.shiftKey){let e=c.x,t=c.y,a=c.handles[d].x,s=c.handles[d].y,n=Math.atan2(s-t,a-e),r=Math.sqrt(Math.pow(a-e,2)+Math.pow(s-t,2));c.handles[h].x=e-r*Math.cos(n),c.handles[h].y=t-r*Math.sin(n)}return{...s,shape:{...s.shape,points:l}}});return{...t,layers:s}}if("pan-image"===w.type&&w.layerId){let s=t.layers.map(s=>{var n;let r,i,o,l,c,d,h,u;if(s.id!==w.layerId)return s;let p=null==(n=w.initialLayerData)?void 0:n.get(s.id);if(!p||!p.pan)return s;if("image"===s.type)r=s.originalWidth,i=s.originalHeight,o=s.fit,l=p.pan,c=s.transform,d=1;else{if("shape"!==s.type||!s.shape.fillImage)return s;r=s.shape.fillImage.originalWidth,i=s.shape.fillImage.originalHeight,o=s.shape.fillImage.fit,l=p.pan,c=s.transform,d=s.shape.fillImage.scale||1}if(!r||!i)return s;let{width:m,height:x}=c,f=l,g=r/i,v=m/x;"cover"===o?v>g?(h=m*d,u=m/g*d):(u=x*d,h=x*g*d):v>g?(u=x*d,h=x*g*d):(h=m*d,u=m/g*d);let y=Math.max(0,h-m),j=Math.max(0,u-x),b=f.x/100*y,N=f.y/100*j,C=e/t.zoom,k=a/t.zoom,I=b-C,M=N-k;I=Math.max(0,Math.min(I,y)),M=Math.max(0,Math.min(M,j));let z={x:y>0?I/y*100:50,y:j>0?M/j*100:50};if("image"===s.type)return{...s,pan:z};if("shape"===s.type&&s.shape.fillImage){let e={...s.shape.fillImage,pan:z};return{...s,shape:{...s.shape,fillImage:e}}}return s});return{...t,layers:s}}if(["move","resize","rotate"].includes(w.type)){let{layers:s,snapLines:n}=function(e,t,a,s,n){let{guides:r}=e.canvas,i=r.enabled&&r.snap,o={horizontal:[],vertical:[]};return{layers:e.layers.map(r=>{var l,c;let d=null==(l=t.initialLayerData)?void 0:l.get(r.id);if(!d)return r;let h=d.transform,u=a/e.zoom,p=s/e.zoom;if("move"===t.type){let a=h.x+u,s=h.y+p;if(i){let n=10/e.zoom,r=new Set,i=new Set;e.canvas.guides.items.forEach(e=>{"vertical"===e.orientation?r.add(e.position):i.add(e.position)}),r.add(0),r.add(e.canvas.width/2),r.add(e.canvas.width),i.add(0),i.add(e.canvas.height/2),i.add(e.canvas.height),e.layers.forEach(e=>{var a;if(null==(a=t.initialLayerData)?void 0:a.has(e.id))return;let{x:s,y:n,width:o,height:l}=e.transform;r.add(s),r.add(s+o/2),r.add(s+o),i.add(n),i.add(n+l/2),i.add(n+l)});let{width:l,height:c}=h,d=0,u=0,p=n,m=n,x=null,f=null;[0,l/2,l].forEach(e=>{let t=a+e;r.forEach(e=>{let a=t-e;Math.abs(a)<p&&(p=Math.abs(a),d=-a,x=e)})}),[0,c/2,c].forEach(e=>{let t=s+e;i.forEach(e=>{let a=t-e;Math.abs(a)<m&&(m=Math.abs(a),u=-a,f=e)})}),null!==x&&(a+=d,o.vertical.push(x)),null!==f&&(s+=u,o.horizontal.push(f))}return{...r,transform:{...h,x:a,y:s}}}if("resize"===t.type&&t.handle){if("image"===r.type&&e.croppingLayerId===r.id){let e=d.crop,a=h.rotation*(Math.PI/180),s=Math.cos(a),n=Math.sin(a),i=u*s+p*n,o=-u*n+p*s,l=0,c=0,m=0,x=0;t.handle.includes("t")&&(l=o/h.height*100),t.handle.includes("b")&&(m=-o/h.height*100),t.handle.includes("l")&&(x=i/h.width*100),t.handle.includes("r")&&(c=-i/h.width*100);let f={top:e.top+l,right:e.right+c,bottom:e.bottom+m,left:e.left+x};return f.top=Math.max(0,f.top),f.right=Math.max(0,f.right),f.bottom=Math.max(0,f.bottom),f.left=Math.max(0,f.left),f.left+f.right>=100&&(t.handle.includes("l")?f.left=100-f.right:f.right=100-f.left),f.top+f.bottom>=100&&(t.handle.includes("t")?f.top=100-f.bottom:f.bottom=100-f.top),{...r,crop:f}}let{x:a,y:s,width:n,height:l,rotation:c}=h,m=Math.PI/180*c,x=Math.cos(m),f=Math.sin(m),g=u*x+p*f,v=-u*f+p*x,y=n,j=l,w=g,b=v;if(i){let r=10/e.zoom,i=new Set,c=new Set;e.canvas.guides.items.forEach(e=>{"vertical"===e.orientation?i.add(e.position):c.add(e.position)}),i.add(0),i.add(e.canvas.width/2),i.add(e.canvas.width),c.add(0),c.add(e.canvas.height/2),c.add(e.canvas.height),e.layers.forEach(e=>{var a;if(null==(a=t.initialLayerData)?void 0:a.has(e.id))return;let{x:s,y:n,width:r,height:o}=e.transform;i.add(s),i.add(s+r/2),i.add(s+r),c.add(n),c.add(n+o/2),c.add(n+o)});let d=n,h=l;t.handle.includes("l")?d-=g:t.handle.includes("r")&&(d+=g),t.handle.includes("t")?h-=v:t.handle.includes("b")&&(h+=v);let u=d-n,p=h-l,m=0,y=0;t.handle.includes("r")?m=u/2:t.handle.includes("l")&&(m=-u/2),t.handle.includes("b")?y=p/2:t.handle.includes("t")&&(y=-p/2);let j=a+n/2+(m*x-y*f),N=s+l/2+(m*f+y*x),C=d/2,k=h/2,I=[{x:-C,y:-k},{x:C,y:-k},{x:C,y:k},{x:-C,y:k}].map(e=>({x:j+e.x*x-e.y*f,y:N+e.x*f+e.y*x})),M=[...I,{x:(I[0].x+I[1].x)/2,y:(I[0].y+I[1].y)/2},{x:(I[1].x+I[2].x)/2,y:(I[1].y+I[2].y)/2},{x:(I[2].x+I[3].x)/2,y:(I[2].y+I[3].y)/2},{x:(I[3].x+I[0].x)/2,y:(I[3].y+I[0].y)/2},{x:j,y:N}],z=({tl:[0,4,7,8],tm:[4,8],tr:[1,4,5,8],ml:[7,8],mr:[5,8],bl:[3,6,7,8],bm:[6,8],br:[2,5,6,8]})[t.handle].map(e=>M[e]),A=0,S=0,L=r,E=r;if(z.forEach(e=>{i.forEach(t=>{let a=e.x-t;Math.abs(a)<L&&(L=Math.abs(a),A=-a)}),c.forEach(t=>{let a=e.y-t;Math.abs(a)<E&&(E=Math.abs(a),S=-a)})}),0!==A||0!==S){let e=A*x+S*f,t=-A*f+S*x;w=g+e,b=v+t,z.forEach(e=>{i.forEach(t=>{.1>Math.abs(e.x+A-t)&&!o.vertical.includes(t)&&o.vertical.push(t)}),c.forEach(t=>{.1>Math.abs(e.y+S-t)&&!o.horizontal.includes(t)&&o.horizontal.push(t)})})}}let N=!t.handle.includes("m"),C=h.width/h.height,k=0;t.handle.includes("l")?k=-w:t.handle.includes("r")&&(k=w);let I=0;t.handle.includes("t")?I=-b:t.handle.includes("b")&&(I=b),N?Math.abs(k)>Math.abs(I)?j=(y=n+k)/C:y=(j=l+I)*C:(y=n+k,j=l+I),y<10&&(y=10,N&&(j=y/C)),j<10&&(j=10,N&&(y=j*C));let M=y-n,z=j-l,A=0,S=0;t.handle.includes("r")?A=M/2:t.handle.includes("l")&&(A=-M/2),t.handle.includes("b")?S=z/2:t.handle.includes("t")&&(S=-z/2);let L=a+n/2+(A*x-S*f)-y/2,E=s+l/2+(A*f+S*x)-j/2;if("text"===r.type&&N){let e=d.initialFontSize;if(e){let t=y/h.width,a=(t+j/h.height)/2*e;return a<4&&(a=4),{...r,transform:{...h,x:L,y:E,width:y,height:j},font:{...r.font,size:a}}}}return{...r,transform:{...h,x:L,y:E,width:y,height:j}}}if("rotate"===t.type){let e=null==(c=document.getElementById("selection-box"))?void 0:c.getBoundingClientRect();if(!e)return r;let a=e.left+e.width/2,s=e.top+e.height/2,i=Math.atan2(t.startY-s,t.startX-a),o=180/Math.PI*(Math.atan2(n.y-s,n.x-a)-i),l=h.rotation+o;return t.shiftKey&&(l=15*Math.round(l/15)),{...r,transform:{...h,rotation:l}}}return r}),snapLines:o}}(t,w,e,a,M.current);return setTimeout(()=>L(n||{horizontal:[],vertical:[]}),0),{...t,layers:s}}return t})}))},s=()=>{if(I.current&&cancelAnimationFrame(I.current),w&&(E.current?(f(E.current,e),E.current=null):["move-node","move-handle","pan-image"].includes(w.type)),(null==w?void 0:w.type)==="move-node"&&w.layerId&&w.pointId){let e=M.current.x-w.startX,t=M.current.y-w.startY;3>Math.abs(e)&&3>Math.abs(t)&&R(w.layerId,w.pointId)}b(null),L({horizontal:[],vertical:[]})};return window.addEventListener("mousemove",a),window.addEventListener("mouseup",s),()=>{window.removeEventListener("mousemove",a),window.removeEventListener("mouseup",s),I.current&&cancelAnimationFrame(I.current)}},[w,t,e,m,f,R]),(0,n.useEffect)(()=>{if((null==d?void 0:d.isActive)&&k.current&&!z){let e=k.current;p({title:"Initializing eyedropper...",description:"Please wait."}),g()(e,{useCORS:!0,logging:!1,backgroundColor:null}).then(e=>{A(e)}).catch(e=>{console.error("Eyedropper snapshot failed:",e),p({title:"Eyedropper failed",description:"Could not create canvas snapshot.",variant:"destructive"}),h(null)})}else(null==d?void 0:d.isActive)||!z||A(null)},[null==d?void 0:d.isActive,z,h,p]),(0,n.useEffect)(()=>{if(!(null==d?void 0:d.isActive)||!z)return;let e=e=>{let t=z.getContext("2d",{willReadFrequently:!0});if(!t||!k.current)return;let a=k.current.getBoundingClientRect(),s=window.devicePixelRatio||1,n=(e.clientX-a.left)*s,r=(e.clientY-a.top)*s,i=Math.max(0,Math.min(n,z.width-1)),o=Math.max(0,Math.min(r,z.height-1)),[l,c,d]=t.getImageData(i,o,1,1).data,h=e=>("0"+e.toString(16)).slice(-2);u("#".concat(h(l)).concat(h(c)).concat(h(d)))};return window.addEventListener("mousemove",e),()=>window.removeEventListener("mousemove",e)},[null==d?void 0:d.isActive,z,u]);let $={transform:"scale(".concat(e.zoom,")"),transformOrigin:"center center"},F=(0,n.useCallback)((a,s)=>{var n;((e,t,a,s,n,r,o)=>{if("node"!==a.activeTool)return;e.stopPropagation();let l=a.layers.find(e=>e.id===t);if(!l||!l.shape.points||!r)return;let c=(e.clientX-r.left)/n-l.transform.x,d=(e.clientY-r.top)/n-l.transform.y,h=-1,u=1/0;for(let e=0;e<l.shape.points.length;e++){let t=l.shape.points[e],a=l.shape.points[(e+1)%l.shape.points.length],s=t.x/100*l.transform.width,n=t.y/100*l.transform.height,r=a.x/100*l.transform.width,i=a.y/100*l.transform.height,o=(r-s)**2+(i-n)**2;if(0===o)continue;let p=((c-s)*(r-s)+(d-n)*(i-n))/o,m=Math.sqrt((c-(s+(p=Math.max(0,Math.min(1,p)))*(r-s)))**2+(d-(n+p*(i-n)))**2);m<u&&(u=m,h=e)}if(-1===h)return;let p=c/l.transform.width*100,m=d/l.transform.height*100,x={id:(0,i.l)(),x:p,y:m,type:"curve",handles:{in:{x:p-10,y:m},out:{x:p+10,y:m}}};s(e=>{let a=e.layers.map(e=>{if(e.id===t){let t=[...e.shape.points];return t.splice(h+1,0,x),{...e,shape:{...e.shape,points:t}}}return e});return{...e,layers:a}}),o({layerId:t,pointId:x.id})})(a,s,e,t,e.zoom,null==(n=k.current)?void 0:n.getBoundingClientRect(),C)},[e,t]),O=(0,n.useCallback)((a,s)=>{if("text"===e.activeTool||"shape"===e.activeTool&&e.activeShapeType)return;a.stopPropagation();let n=e.layers.find(e=>e.id===s);if(!n)return;if(e.croppingLayerId===s&&("image"===n.type||"shape"===n.type&&n.shape.fillImage)){let e="image"===n.type?n.pan:n.shape.fillImage.pan;if(!e)return;let t=new Map;t.set(n.id,{transform:{...n.transform},pan:e}),b({type:"pan-image",startX:a.clientX,startY:a.clientY,initialLayerData:t,shiftKey:a.shiftKey,layerId:s});return}let r=n.groupId?e.groups.find(e=>e.id===n.groupId):null;if(!n.locked&&(!r||!r.locked))if("select"===e.activeTool){E.current=e;let n=e.selectedLayers.includes(s),r=[...e.selectedLayers],i=!1;a.shiftKey?(n?r=r.filter(e=>e!==s):r.push(s),i=!0):n||(r=[s],i=!0);let o=new Map;e.layers.forEach(e=>{r.includes(e.id)&&o.set(e.id,{transform:{...e.transform}})}),b({type:"move",startX:a.clientX,startY:a.clientY,initialLayerData:o,shiftKey:a.shiftKey}),i&&t(e=>({...e,selectedLayers:r}))}else{let n=e.selectedLayers.includes(s),r=[...e.selectedLayers];a.shiftKey?n?r=r.filter(e=>e!==s):r.push(s):n||(r=[s]),t(e=>({...e,selectedLayers:r}))}},[e.activeTool,e.layers,e.selectedLayers,e.groups,e.croppingLayerId,t,e.activeShapeType,e]),Y=1===e.selectedLayers.length&&"select"===e.activeTool,U=Y?e.layers.find(t=>t.id===e.selectedLayers[0]):null,X=e.croppingLayerId===(null==U?void 0:U.id),V={},B={position:"absolute",inset:0};if(Y&&U&&(V={position:"absolute",left:U.transform.x,top:U.transform.y,width:U.transform.width,height:U.transform.height,transform:"rotate(".concat(U.transform.rotation,"deg)"),zIndex:9999,pointerEvents:"none"},"image"===U.type&&!X)){let{crop:e,transform:t}=U,a=t.width*(e.left/100),s=t.height*(e.top/100);B={position:"absolute",left:a,top:s,width:t.width*(1-(e.left+e.right)/100),height:t.height*(1-(e.top+e.bottom)/100)}}return(0,s.jsx)("div",{className:"p-16 flex items-center justify-center overflow-auto",onMouseDown:s=>{if(null==d?void 0:d.isActive){if(s.preventDefault(),s.stopPropagation(),!z)return void p({title:"Eyedropper not ready",description:"Snapshot is being created, please wait.",variant:"destructive"});let t=z.getContext("2d");if(!t||!k.current)return void h(null);let a=k.current.getBoundingClientRect(),n=window.devicePixelRatio||1,r=(s.clientX-a.left)*n,i=(s.clientY-a.top)*n,[o,l,c,d]=t.getImageData(r,i,1,1).data;if(0===d)h("transparent"===e.canvas.background?"#ffffff":e.canvas.background);else{let e=e=>("0"+e.toString(16)).slice(-2);h("#".concat(e(o)).concat(e(l)).concat(e(c)))}return}let n="text"===e.activeTool||"shape"===e.activeTool&&e.activeShapeType;if(e.croppingLayerId&&t(e=>({...e,croppingLayerId:null})),s.shiftKey||n||t(e=>({...e,selectedLayers:[]})),!n||!k.current)return;let r=k.current.getBoundingClientRect(),o=(s.clientX-r.left)/e.zoom,l=(s.clientY-r.top)/e.zoom,{guides:c}=e.canvas;if(c.enabled&&c.snap){let t=10/e.zoom;for(let e of c.items)"vertical"===e.orientation&&Math.abs(o-e.position)<t&&(o=e.position),"horizontal"===e.orientation&&Math.abs(l-e.position)<t&&(l=e.position)}if("text"===e.activeTool){let s={id:(0,i.l)(),type:"text",name:"New Text",visible:!0,locked:!1,zIndex:e.layers.length,transform:{x:o-200,y:l-30,width:400,height:60,rotation:0,opacity:1},content:"New Text",padding:0,font:{family:"Inter",size:48,weight:400,lineHeight:1.2,letterSpacing:0,align:"center",style:"normal",decoration:"none",shadow:null,outline:null,curve:null},color:{type:"solid",mode:"mapped",value:"primary"}};t(e=>({...e,layers:[...e.layers,s],selectedLayers:[s.id]})),a("select")}else if("shape"===e.activeTool&&e.activeShapeType){let s="line"===e.activeShapeType||"dashed-line"===e.activeShapeType,n={id:(0,i.l)(),type:"shape",name:"".concat(e.activeShapeType.charAt(0).toUpperCase()+e.activeShapeType.slice(1)," Layer"),visible:!0,locked:!1,zIndex:e.layers.length,transform:{x:o-250,y:l-(s?5:250),width:500,height:s?10:500,rotation:0,opacity:1},shape:{primitive:e.activeShapeType,fill:s?{type:"solid",mode:"custom",value:"transparent"}:{type:"solid",mode:"mapped",value:"primary"},stroke:s?{color:{type:"solid",mode:"mapped",value:"primary"},width:4,dash:"dashed-line"===e.activeShapeType?"8 8":void 0}:null,isClosed:!s,shadow:null}};t(e=>({...e,layers:[...e.layers,n],selectedLayers:[n.id]})),a("select")}},children:(0,s.jsx)("div",{style:$,className:"transition-transform duration-200",children:(0,s.jsxs)("div",{id:"canvas-area",ref:k,style:{width:"".concat(v,"px"),height:"".concat(y,"px"),backgroundColor:"transparent"===j?void 0:j,boxShadow:"0 0 10px rgba(0, 0, 0, 0.1)"},className:(0,o.cn)("relative","transparent"===j?"checkerboard":""),children:[e.canvas.guides.enabled&&e.canvas.guides.items.map(t=>{let a=8/e.zoom,n=1/e.zoom;return(0,s.jsx)("div",{onMouseDown:e=>J(e,t.id),style:{position:"absolute",..."horizontal"===t.orientation?{top:t.position-a/2,left:0,width:"100%",height:"".concat(a,"px"),cursor:"row-resize"}:{left:t.position-a/2,top:0,height:"100%",width:"".concat(a,"px"),cursor:"col-resize"},zIndex:9998,pointerEvents:"auto"},children:(0,s.jsx)("div",{style:{position:"absolute",backgroundColor:"rgba(25, 118, 210, 0.7)",..."horizontal"===t.orientation?{top:"50%",transform:"translateY(-50%)",width:"100%",height:"".concat(n,"px")}:{left:"50%",transform:"translateX(-50%)",height:"100%",width:"".concat(n,"px")}}})},t.id)}),S.vertical.map((t,a)=>(0,s.jsx)("div",{style:{position:"absolute",left:t,top:0,width:"".concat(1/e.zoom,"px"),height:"100%",backgroundColor:"#ef4444",zIndex:99999}},"snap-v-".concat(a))),S.horizontal.map((t,a)=>(0,s.jsx)("div",{style:{position:"absolute",top:t,left:0,height:"".concat(1/e.zoom,"px"),width:"100%",backgroundColor:"#ef4444",zIndex:99999}},"snap-h-".concat(a))),e.layers.sort((e,t)=>e.zIndex-t.zIndex).map(e=>(0,s.jsx)(x,{layer:e,onMouseDown:O,onNodeMouseDown:P,onPathMouseDown:F,action:w,deleteNode:D},e.id)),Y&&U&&(0,s.jsxs)("div",{id:"selection-box",style:V,children:[(0,s.jsxs)("div",{style:B,children:[(0,s.jsx)("div",{className:(0,o.cn)("absolute inset-0 border-2 pointer-events-none",X?"border-dashed border-white":"border-ring")}),[{key:"tl",cursor:"nwse-resize"},{key:"tm",cursor:"ns-resize"},{key:"tr",cursor:"nesw-resize"},{key:"ml",cursor:"ew-resize"},{key:"mr",cursor:"ew-resize"},{key:"bl",cursor:"nesw-resize"},{key:"bm",cursor:"ns-resize"},{key:"br",cursor:"nwse-resize"}].map(e=>{let{key:t,cursor:a}=e,n={cursor:a,width:48,height:48,pointerEvents:"auto"};return t.includes("t")&&(n.top=-24),t.includes("b")&&(n.bottom=-24),t.includes("l")&&(n.left=-24),t.includes("r")&&(n.right=-24),t.includes("m")&&t.includes("l")&&(n.top="calc(50% - ".concat(24,"px)")),t.includes("m")&&t.includes("r")&&(n.top="calc(50% - ".concat(24,"px)")),t.includes("t")&&t.includes("m")&&(n.left="calc(50% - ".concat(24,"px)")),t.includes("b")&&t.includes("m")&&(n.left="calc(50% - ".concat(24,"px)")),(0,s.jsx)("div",{onMouseDown:e=>T(e,"resize",t),style:n,className:"absolute border-2 border-background bg-ring rounded-sm transition-transform hover:scale-125"},t)})]}),!X&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{onMouseDown:e=>T(e,"rotate"),style:{top:"calc(".concat(B.top,"px - ").concat(64,"px)"),left:"calc(".concat(B.left,"px + ").concat(B.width,"px / 2 - ").concat(24,"px)"),cursor:"crosshair",width:48,height:48,pointerEvents:"auto"},className:"absolute border-2 border-background bg-ring rounded-full transition-transform hover:scale-125"}),(0,s.jsx)("div",{style:{top:"calc(".concat(B.top,"px - ").concat(64,"px + ").concat(48,"px)"),left:"calc(".concat(B.left,"px + ").concat(B.width,"px / 2 - 1px)"),height:16,width:"2px",backgroundColor:"hsl(var(--ring))"},className:"absolute pointer-events-none"})]})]})]})})})}},1568:(e,t,a)=>{"use strict";a.d(t,{Y:()=>r});var s={};a.r(s),a.d(s,{handleImageFile:()=>n});let n=async e=>{let t=new FormData;t.append("image",e);let a=await fetch("/api/images/upload",{method:"POST",body:t});if(!a.ok)throw Error("Image upload failed on the server.");let{src:s,width:n,height:r}=await a.json();return{src:s,width:n,height:r}},r=s.handleImageFile},3226:(e,t,a)=>{"use strict";a.d(t,{p:()=>i});var s=a(3424),n=a(3884),r=a(9257);let i=n.forwardRef((e,t)=>{let{className:a,type:n,...i}=e;return(0,s.jsx)("input",{type:n,className:(0,r.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...i})});i.displayName="Input"},3360:(e,t,a)=>{"use strict";a.d(t,{J:()=>c});var s=a(3424),n=a(3884),r=a(1057),i=a(7294),o=a(9257);let l=(0,i.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(r.b,{ref:t,className:(0,o.cn)(l(),a),...n})});c.displayName=r.b.displayName},3844:(e,t,a)=>{"use strict";a.d(t,{default:()=>z});var s=a(3424),n=a(3884),r=a(6418),i=a(8611),o=a(5114),l=a(9257),c=a(2050),d=a(8282),h=a(8467),u=a(7248),p=a(5334),m=a(4990),x=a(4193),f=a(1198),g=a(7062),v=a(6478),y=a(4669),j=a(9914);let w=[{name:"rect",icon:x.A,label:"Rectangle"},{name:"circle",icon:f.A,label:"Circle"},{name:"pentagon",icon:g.A,label:"Pentagon"},{name:"heart",icon:v.A,label:"Heart"},{name:"star",icon:y.A,label:"Star"},{name:"line",icon:j.A,label:"Line"},{name:"dashed-line",icon:e=>(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[(0,s.jsx)("path",{d:"M5 12h2"}),(0,s.jsx)("path",{d:"M11 12h2"}),(0,s.jsx)("path",{d:"M17 12h2"})]}),label:"Dashed Line"}];function b(e){let{children:t,onShapeSelect:a,open:n,onOpenChange:r}=e;return(0,s.jsxs)(m.lG,{open:n,onOpenChange:r,children:[(0,s.jsx)(m.zM,{asChild:!0,children:t}),(0,s.jsxs)(m.Cf,{className:"sm:max-w-[425px]",children:[(0,s.jsx)(m.c7,{children:(0,s.jsx)(m.L3,{children:"Choose a shape"})}),(0,s.jsx)("div",{className:"grid grid-cols-3 gap-4 py-4",children:w.map(e=>(0,s.jsxs)(o.$,{variant:"outline",className:"flex flex-col h-24",onClick:()=>{a(e.name),r(!1)},children:[(0,s.jsx)(e.icon,{className:"h-8 w-8 mb-2"}),e.label]},e.name))})]})]})}var N=a(3226),C=a(3360),k=a(1568);function I(e){let{children:t,open:a,onOpenChange:i}=e,{addImageLayer:l,toast:c}=(0,r.h)(),[d,h]=(0,n.useState)(null),[u,p]=(0,n.useState)(null),[x,f]=(0,n.useState)(!1),g=(0,n.useRef)(null),v=async e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];if(a){f(!0);try{let{src:e,width:t,height:s}=await (0,k.Y)(a);h(e),p({width:t,height:s})}catch(e){console.error(e),c({variant:"destructive",title:"Image Processing Failed",description:"Could not process the selected image."}),y()}finally{f(!1)}}},y=()=>{h(null),p(null),f(!1),g.current&&(g.current.value="")};return(0,s.jsxs)(m.lG,{open:a,onOpenChange:e=>{e||y(),i(e)},children:[(0,s.jsx)(m.zM,{asChild:!0,children:t}),(0,s.jsxs)(m.Cf,{className:"sm:max-w-md",children:[(0,s.jsx)(m.c7,{children:(0,s.jsx)(m.L3,{children:"Upload an Image"})}),(0,s.jsxs)("div",{className:"space-y-4 py-4",children:[(0,s.jsxs)("div",{className:"grid w-full max-w-sm items-center gap-1.5",children:[(0,s.jsx)(C.J,{htmlFor:"image-upload",children:"Picture"}),(0,s.jsx)(N.p,{id:"image-upload",type:"file",accept:"image/*",onChange:v,ref:g,disabled:x})]}),x&&(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Processing image..."}),d&&(0,s.jsx)("div",{className:"border rounded-md p-2 flex items-center justify-center bg-muted/40",children:(0,s.jsx)("img",{src:d,alt:"Preview",className:"max-h-64 rounded-md"})})]}),(0,s.jsx)(o.$,{onClick:()=>{d&&u&&(l(d,u.width,u.height),i(!1),y())},disabled:!d||x,children:"Add to Canvas"})]})]})}let M=[{name:"select",icon:c.A,label:"Select (V)"},{name:"text",icon:d.A,label:"Text (T)"},{name:"image",icon:h.A,label:"Image (I)"},{name:"shape",icon:u.A,label:"Shape (S)"},{name:"node",icon:p.A,label:"Node Edit (P)"}];function z(){let{project:e,setActiveTool:t,setSelectedShape:a}=(0,r.h)(),[c,d]=(0,n.useState)(!1),[h,u]=(0,n.useState)(!1);return(0,s.jsx)("aside",{className:"w-16 flex flex-col items-center gap-2 py-4 border-r bg-card",children:(0,s.jsx)(i.Bc,{delayDuration:0,children:(0,s.jsx)("nav",{className:"flex flex-col gap-2",children:M.map(n=>{let r="shape"===n.name,p="image"===n.name,m=(0,s.jsxs)(i.m_,{children:[(0,s.jsx)(i.k$,{asChild:!0,children:(0,s.jsx)(o.$,{variant:"ghost",size:"icon",className:(0,l.cn)("rounded-lg",e.activeTool===n.name&&"bg-primary text-primary-foreground hover:bg-primary/90 hover:text-primary-foreground"),onClick:()=>{var e;"shape"===(e=n.name)?d(!0):"image"===e?u(!0):t(e)},"aria-label":n.label,children:(0,s.jsx)(n.icon,{className:"h-5 w-5"})})}),(0,s.jsx)(i.ZI,{side:"right",children:(0,s.jsx)("p",{children:n.label})})]},n.name);return r?(0,s.jsx)(b,{open:c,onOpenChange:d,onShapeSelect:a,children:m},"shape-dialog"):p?(0,s.jsx)(I,{open:h,onOpenChange:u,children:m},"image-dialog"):m})})})})}},4990:(e,t,a)=>{"use strict";a.d(t,{Cf:()=>u,Es:()=>m,L3:()=>x,c7:()=>p,lG:()=>l,rr:()=>f,zM:()=>c});var s=a(3424),n=a(3884),r=a(9396),i=a(1810),o=a(9257);let l=r.bL,c=r.l9,d=r.ZL;r.bm;let h=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(r.hJ,{ref:t,className:(0,o.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...n})});h.displayName=r.hJ.displayName;let u=n.forwardRef((e,t)=>{let{className:a,children:n,...l}=e;return(0,s.jsxs)(d,{children:[(0,s.jsx)(h,{}),(0,s.jsxs)(r.UC,{ref:t,className:(0,o.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...l,children:[n,(0,s.jsxs)(r.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(i.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});u.displayName=r.UC.displayName;let p=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,o.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};p.displayName="DialogHeader";let m=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,o.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};m.displayName="DialogFooter";let x=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(r.hE,{ref:t,className:(0,o.cn)("text-lg font-semibold leading-none tracking-tight",a),...n})});x.displayName=r.hE.displayName;let f=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(r.VY,{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",a),...n})});f.displayName=r.VY.displayName},5114:(e,t,a)=>{"use strict";a.d(t,{$:()=>c,r:()=>l});var s=a(3424),n=a(3884),r=a(9592),i=a(7294),o=a(9257);let l=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=n.forwardRef((e,t)=>{let{className:a,variant:n,size:i,asChild:c=!1,...d}=e,h=c?r.DX:"button";return(0,s.jsx)(h,{className:(0,o.cn)(l({variant:n,size:i,className:a})),ref:t,...d})});c.displayName="Button"},6418:(e,t,a)=>{"use strict";a.d(t,{EditorProvider:()=>g,h:()=>v});var s={};a.r(s),a.d(s,{exportProject:()=>p});var n=a(3424),r=a(3884),i=a(6447),o=a(8754),l=a(7795),c=a(9793),d=a(8661);function h(e,t){return"solid"===e.type?"custom"===e.mode?e.value:t[e.value]||"#000000":"transparent"}function u(e,t){var a,s,n,r;let i=e=>Object.entries(e).map(e=>{let[t,a]=e;return null==a?"":"".concat(t.replace(/[A-Z]/g,e=>"-"+e.toLowerCase()),":").concat(a,";")}).join(""),o={position:"absolute",left:"".concat(e.transform.x,"px"),top:"".concat(e.transform.y,"px"),width:"".concat(e.transform.width,"px"),height:"".concat(e.transform.height,"px"),transform:"rotate(".concat(e.transform.rotation,"deg)"),opacity:e.transform.opacity,visibility:e.visible?"visible":"hidden",zIndex:e.zIndex,filter:e.transform.blur?"blur(".concat(e.transform.blur,"px)"):void 0},l='data-name="'.concat(e.name.replace(/"/g,"&quot;"),'"'),d="layer-name--".concat(e.name.replace(/\s+/g,"-").toLowerCase().replace(/[^a-z0-9-]/g,""));if("text"===e.type){let s=e.font,n={...o},r="left"===s.align?"flex-start":"right"===s.align?"flex-end":"center";n.display="flex",n.alignItems="center",n.justifyContent=r,n.padding=e.padding?"".concat(e.padding,"px"):void 0,n.fontSize="".concat(s.size,"px"),n.fontWeight=s.weight,n.fontFamily="'".concat(s.family,"', sans-serif"),n.lineHeight=s.lineHeight,n.letterSpacing="".concat(s.letterSpacing,"px"),n.textAlign=s.align,n.fontStyle=s.style,n.textDecoration=s.decoration,n.textShadow=s.shadow?"".concat(s.shadow.offsetX,"px ").concat(s.shadow.offsetY,"px ").concat(s.shadow.blur,"px ").concat(s.shadow.color):"none";let c="",u="";(s.outline&&(n.WebkitTextStroke="".concat(s.outline.width,"px ").concat(s.outline.color)),"solid"!==e.color.type)?(c+=" gradient-text",u+=".layer-".concat(e.id," { background: ").concat("linear"===(a=e.color).type?"linear-gradient(".concat(a.angle,"deg, ").concat(a.stops.map(e=>"".concat(e.color," ").concat(e.position,"%")).join(", "),")"):"radial"===a.type?"radial-gradient(".concat(a.shape,", ").concat(a.stops.map(e=>"".concat(e.color," ").concat(e.position,"%")).join(", "),")"):"none","; }"),n.color="transparent"):n.color=h(e.color,t.colors);let p=e.content.replace(/\n/g,"<br />");return"<div ".concat(l,' class="layer layer-text ').concat(d," layer-").concat(e.id," ").concat(c,'" style="').concat(i(n),'">').concat(p,"</div><style>").concat(u,"</style>")}if("image"===e.type){let t={...o,overflow:"hidden",filter:e.shadow?"drop-shadow(".concat(e.shadow.offsetX,"px ").concat(e.shadow.offsetY,"px ").concat(e.shadow.blur,"px ").concat(e.shadow.color,")"):"none"},a={width:"100%",height:"100%",objectFit:e.fit,objectPosition:"".concat(e.pan.x,"% ").concat(e.pan.y,"%"),clipPath:"inset(".concat(e.crop.top,"% ").concat(e.crop.right,"% ").concat(e.crop.bottom,"% ").concat(e.crop.left,"%)")};return"<div ".concat(l,' class="layer layer-image ').concat(d,'" style="').concat(i(t),'"><img src="').concat(e.src,'" style="').concat(i(a),'" alt="').concat(e.name.replace(/"/g,"&quot;"),'"/></div>')}if("shape"===e.type){let a=e.shape,u=(0,c.bP)(e),p=!1===a.isClosed?"none":"solid"===a.fill.type?h(a.fill,t.colors):"url(#fill-".concat(e.id,")"),m=a.stroke?"solid"===a.stroke.color.type?h(a.stroke.color,t.colors):"url(#stroke-".concat(e.id,")"):"none",x="";if("solid"!==a.fill.type&&!1!==a.isClosed){let t=a.fill;"linear"===t.type?x+='<linearGradient id="fill-'.concat(e.id,'" gradientTransform="rotate(').concat(t.angle,', 0.5, 0.5)">').concat(t.stops.map(e=>'<stop offset="'.concat(e.position,'%" stop-color="').concat(e.color,'" />')).join(""),"</linearGradient>"):x+='<radialGradient id="fill-'.concat(e.id,'" gradientUnits="objectBoundingBox" cx="0.5" cy="0.5" r="0.5">').concat(t.stops.map(e=>'<stop offset="'.concat(e.position,'%" stop-color="').concat(e.color,'" />')).join(""),"</radialGradient>")}if(a.stroke&&"solid"!==a.stroke.color.type){let t=a.stroke.color;"linear"===t.type?x+='<linearGradient id="stroke-'.concat(e.id,'" gradientTransform="rotate(').concat(t.angle,', 0.5, 0.5)">').concat(t.stops.map(e=>'<stop offset="'.concat(e.position,'%" stop-color="').concat(e.color,'" />')).join(""),"</linearGradient>"):x+='<radialGradient id="stroke-'.concat(e.id,'" gradientUnits="objectBoundingBox" cx="0.5" cy="0.5" r="0.5">').concat(t.stops.map(e=>'<stop offset="'.concat(e.position,'%" stop-color="').concat(e.color,'" />')).join(""),"</radialGradient>")}a.shadow&&(x+='<filter id="shadow-'.concat(e.id,'" x="-50%" y="-50%" width="200%" height="200%"><feDropShadow dx="').concat(a.shadow.offsetX,'" dy="').concat(a.shadow.offsetY,'" stdDeviation="').concat(a.shadow.blur/2,'" flood-color="').concat(a.shadow.color,'"/></filter>'));let f="";(null==(s=a.fillImage)?void 0:s.src)&&!1!==a.isClosed&&(x+='<clipPath id="clip-'.concat(e.id,'"><path d="').concat(u,'" /></clipPath>'),f='<g clip-path="url(#clip-'.concat(e.id,')"><image href="').concat(a.fillImage.src,'" x="0" y="0" width="100%" height="100%" preserveAspectRatio="').concat("cover"===a.fillImage.fit?"xMidYMid slice":"xMidYMid meet",'" /></g>'));let g='\n            <svg width="100%" height="100%" viewBox="0 0 '.concat(e.transform.width," ").concat(e.transform.height,'" style="overflow:visible;">\n                <defs>').concat(x,'</defs>\n                <path d="').concat(u,'" fill="').concat(p,'" stroke="').concat(m,'" stroke-width="').concat((null==(n=a.stroke)?void 0:n.width)||0,'" stroke-dasharray="').concat((null==(r=a.stroke)?void 0:r.dash)||"none",'" style="').concat(a.shadow?"filter:url(#shadow-".concat(e.id,");"):"",'" />\n                ').concat(f,"\n            </svg>\n        ");return"<div ".concat(l,' class="layer layer-shape ').concat(d,'" style="').concat(i(o),'">').concat(g,"</div>")}return""}let p=async e=>{let t=function(e){let{canvas:t,meta:a,colors:s,layers:n,groups:r}=e,i={width:"".concat(t.width,"px"),height:"".concat(t.height,"px"),background:"transparent"===t.background?"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAACdJREFUOE9jZGBgEGHAD97/16Fft/6vUX/d+j8qO3BqLMSAFwDE+wA53Qx/XQAAAABJRU5ErkJggg==) repeat":t.background,position:"relative",margin:"0 auto",overflow:"hidden"},o=n.sort((e,t)=>e.zIndex-t.zIndex),l=new Set,c=[];for(let t of o)if(t.groupId){if(l.has(t.groupId))continue;let a=r.find(e=>e.id===t.groupId);if(a){let t=a.name,s=o.filter(e=>e.groupId===a.id).map(t=>u(t,e)).join("\n"),n=t.replace(/\s+/g,"-").toLowerCase().replace(/[^a-z0-9-]/g,""),r='data-group-name="'.concat(t.replace(/"/g,"&quot;"),'"');c.push("<div ".concat(r,' class="group-container group-name--').concat(n,'">\n').concat(s,"\n</div>")),l.add(a.id)}else c.push(u(t,e))}else c.push(u(t,e));let h=c.join("\n"),p=d.y1.map(e=>e.variants.map(t=>"\n          @font-face {\n            font-family: '".concat(e.family,"';\n            src: url('").concat(t.url,"') format('woff2');\n            font-weight: ").concat(t.weight,";\n            font-style: ").concat(t.style,";\n            font-display: swap;\n          }\n        ")).join("")).join("").replace(/\n\s*/g,"");return'\n        <!DOCTYPE html>\n        <html \n            lang="en"\n            data-flyer-name="'.concat(a.name,'" \n            data-flyer-category="').concat(a.category,'" \n            data-flyer-width="').concat(t.width,'"\n            data-flyer-height="').concat(t.height,'"\n            data-primary-color="').concat(s.primary,'"\n            data-secondary-color="').concat(s.secondary,'"\n            data-accent-color="').concat(s.accent,'"\n        >\n        <head>\n            <meta charset="UTF-8">\n            <meta name="viewport" content="width=device-width, initial-scale=1.0">\n            <title>').concat(a.name,"</title>\n            <style>\n                body {\n                    margin: 0;\n                    display: flex;\n                    justify-content: center;\n                    align-items: center;\n                    min-height: 100vh;\n                    background-color: #f0f0f0;\n                }\n                .flyer-container {\n                    box-shadow: 0 0 20px rgba(0,0,0,0.15);\n                }\n                .gradient-text {\n                  -webkit-background-clip: text;\n                  background-clip: text;\n                }\n                ").concat(p,'\n            </style>\n            <link rel="preconnect" href="https://fonts.googleapis.com" />\n            <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />\n            <link href="').concat((0,d.kq)(),'" rel="stylesheet" />\n        </head>\n        <body>\n            <div class="flyer-container" style="').concat(Object.entries(i).map(e=>{let[t,a]=e;return null==a?"":"".concat(t.replace(/[A-Z]/g,e=>"-"+e.toLowerCase()),":").concat(a,";")}).join(""),'">\n                ').concat(h,"\n            </div>\n        </body>\n        </html>\n    ")}(e),a=await fetch("/api/export",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({html:t,category:e.meta.category,name:e.meta.name})});if(!a.ok)throw Error((await a.json()).message||"Failed to export project on the server.");let{url:s}=await a.json();console.log("Project exported to server at: ".concat(s))},m=s.exportProject,x=r.createContext(void 0),f={meta:{id:"new-project",name:"Untitled Design",description:"",category:"flyers",createdAt:"",updatedAt:""},canvas:{width:1080,height:1350,background:"transparent",guides:{enabled:!0,snap:!0,items:[]}},colors:{primary:"#111111",secondary:"#ffffff",accent:"#f43f5e"},groups:[{id:"editable-group",name:"Editable",visible:!0,locked:!1,layerIds:[]}],layers:[],selectedLayers:[],activeTool:"select",zoom:1,croppingLayerId:null,zoomAction:null},g=e=>{let{children:t}=e,[a,s]=(0,r.useState)({past:[],present:f,future:[]}),c=a.past.length>0,d=a.future.length>0,[h,u]=(0,r.useState)(null),{toast:p}=(0,o.dj)(),g=(0,r.useCallback)(e=>{s(t=>{let a="function"==typeof e?e(t.present):e;return JSON.stringify(a)===JSON.stringify(t.present)?t:{past:[...t.past,t.present],present:a,future:[]}})},[]),v=(0,r.useCallback)(e=>{s(t=>{let a="function"==typeof e?e(t.present):e;return{...t,present:a}})},[]),y=(0,r.useCallback)((e,t)=>{s(a=>({past:[...a.past,e],present:t,future:[]}))},[]),j=(0,r.useCallback)(()=>{c&&s(e=>{let t=e.past[e.past.length-1];return{past:e.past.slice(0,e.past.length-1),present:t,future:[e.present,...e.future]}})},[c]),w=(0,r.useCallback)(()=>{d&&s(e=>{let t=e.future[0],a=e.future.slice(1);return{past:[...e.past,e.present],present:t,future:a}})},[d]);(0,r.useEffect)(()=>{if("new-project"===a.present.meta.id){let e=new Date().toISOString();g(t=>({...t,meta:{...t.meta,id:(0,i.l)(),createdAt:e,updatedAt:e}}))}},[a.present.meta.id,g]),(0,r.useEffect)(()=>{document.body.style.cursor=(null==h?void 0:h.isActive)?"crosshair":"";let e=e=>{"Escape"===e.key&&(null==h?void 0:h.isActive)&&G(null)};return window.addEventListener("keydown",e),()=>{document.body.style.cursor="",window.removeEventListener("keydown",e)}},[h]);let b=(0,r.useCallback)(e=>{g(t=>e===t.activeTool?t:{...t,activeTool:e})},[g]),N=(0,r.useCallback)(e=>{g(t=>({...t,activeTool:"shape",activeShapeType:e,selectedLayers:[]}))},[g]),C=(0,r.useCallback)((e,t,a)=>{let s=300/(t/a);g(n=>{let r={id:(0,i.l)(),type:"image",name:"Image Layer",visible:!0,locked:!1,zIndex:n.layers.length,transform:{x:(n.canvas.width-300)/2,y:(n.canvas.height-s)/2,width:300,height:s,rotation:0,opacity:1},src:e,originalWidth:t,originalHeight:a,fit:"cover",pan:{x:50,y:50},crop:{top:0,right:0,bottom:0,left:0},filters:{brightness:1,contrast:1,saturation:1,hue:0,exposure:0,grayscale:!1},chromaKey:{enabled:!1,color:"#00ff00",tolerance:.1,feather:0,invert:!1},shadow:null};return{...n,layers:[...n.layers,r],selectedLayers:[r.id],activeTool:"select"}})},[g]),k=(0,r.useCallback)(e=>{g(t=>({...t,selectedLayers:e}))},[g]),I=(0,r.useCallback)(e=>{g(t=>{let a=t.layers.find(t=>t.id===e);return a&&("image"===a.type||"shape"===a.type&&a.shape.fillImage)?t.croppingLayerId===e?{...t,croppingLayerId:null,activeTool:"select"}:{...t,croppingLayerId:e,activeTool:"select",selectedLayers:[e]}:t})},[g]),M=(0,r.useCallback)((e,t)=>{g(a=>({...a,layers:a.layers.map(a=>a.id===e?{...a,...t}:a)}))},[g]),z=(0,r.useCallback)(e=>{g(t=>{let a=t.layers.filter(t=>!e.includes(t.id)).sort((e,t)=>e.zIndex-t.zIndex).map((e,t)=>({...e,zIndex:t})),s=t.groups.map(t=>({...t,layerIds:t.layerIds.filter(t=>!e.includes(t))})).filter(e=>e.layerIds.length>0||"editable-group"===e.id);return{...t,layers:a,groups:s,selectedLayers:t.selectedLayers.filter(t=>!e.includes(t))}})},[g]),A=(0,r.useCallback)(e=>{g(t=>{let a=t.layers.filter(t=>e.includes(t.id));if(0===a.length)return t;let s=[],n=[];a.forEach(e=>{let t=JSON.parse(JSON.stringify(e));t.id=(0,i.l)(),t.name="".concat(e.name," copy"),t.transform.x+=20,t.transform.y+=20,s.push(t),n.push(t.id)});let r=[...t.layers].sort((e,t)=>e.zIndex-t.zIndex),o=a.reduce((e,t)=>t.zIndex>e.zIndex?t:e,a[0]),l=r.findIndex(e=>e.id===o.id)+1;r.splice(l,0,...s);let c=r.map((e,t)=>({...e,zIndex:t}));return{...t,layers:c,selectedLayers:n}})},[g]),S=(0,r.useCallback)((e,t)=>{g(a=>{let s,n=[...a.layers].sort((e,t)=>t.zIndex-e.zIndex),r=n.find(t=>t.id===e);if(!r)return a;let i=n.filter(e=>e.groupId===r.groupId),o=i.findIndex(t=>t.id===e);if(-1===o)return a;if("up"===t){if(0===o)return a;s=o-1}else{if(o===i.length-1)return a;s=o+1}let l=i[s],c=a.layers.map(e=>e.id===r.id?{...e,zIndex:l.zIndex}:e.id===l.id?{...e,zIndex:r.zIndex}:e);return{...a,layers:c}})},[g]),L=(0,r.useCallback)(e=>{g(t=>{let a=t.layers.filter(e=>t.selectedLayers.includes(e.id));if(0===a.length)return t;let s=[...t.layers];if(1===a.length){let n=a[0],r={...n.transform};switch(e){case"left":r.x=0;break;case"center":r.x=(t.canvas.width-n.transform.width)/2;break;case"right":r.x=t.canvas.width-n.transform.width;break;case"top":r.y=0;break;case"middle":r.y=(t.canvas.height-n.transform.height)/2;break;case"bottom":r.y=t.canvas.height-n.transform.height}let i=s.findIndex(e=>e.id===n.id);s[i]={...n,transform:r}}else{let t=a.reduce((e,t)=>({minX:Math.min(e.minX,t.transform.x),minY:Math.min(e.minY,t.transform.y),maxX:Math.max(e.maxX,t.transform.x+t.transform.width),maxY:Math.max(e.maxY,t.transform.y+t.transform.height)}),{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0});a.forEach(a=>{let n=s.findIndex(e=>e.id===a.id),r={...a.transform};switch(e){case"left":r.x=t.minX;break;case"center":r.x=t.minX+(t.maxX-t.minX-a.transform.width)/2;break;case"right":r.x=t.maxX-a.transform.width;break;case"top":r.y=t.minY;break;case"middle":r.y=t.minY+(t.maxY-t.minY-a.transform.height)/2;break;case"bottom":r.y=t.maxY-a.transform.height}s[n]={...a,transform:r}})}return{...t,layers:s}})},[g]),E=(0,r.useCallback)(()=>{g(e=>{if(0===e.selectedLayers.length)return e;let t=new Set(e.selectedLayers),a=e.layers.filter(e=>t.has(e.id)),s=[...e.layers.filter(e=>!t.has(e.id)),...a].map((e,t)=>({...e,zIndex:t}));return{...e,layers:s}})},[g]),D=(0,r.useCallback)(()=>{g(e=>{if(0===e.selectedLayers.length)return e;let t=new Set(e.selectedLayers),a=[...e.layers.filter(e=>t.has(e.id)),...e.layers.filter(e=>!t.has(e.id))].map((e,t)=>({...e,zIndex:t}));return{...e,layers:a}})},[g]),T=(0,r.useCallback)(e=>{g(t=>{if(e.length<1)return t;let a={id:(0,i.l)(),name:"New Group",visible:!0,locked:!1,layerIds:e},s=t.layers.map(t=>e.includes(t.id)?{...t,groupId:a.id}:t);return{...t,groups:[...t.groups,a],layers:s,selectedLayers:[]}})},[g]),R=(0,r.useCallback)(e=>{g(t=>{let a=t.groups.find(t=>t.id===e);if(!a)return t;let s=t.layers.map(t=>t.groupId===e?{...t,groupId:void 0}:t),n=t.groups.filter(t=>t.id!==e);return{...t,groups:n,layers:s,selectedLayers:a.layerIds}})},[g]),P=(0,r.useCallback)((e,t)=>{g(a=>({...a,groups:a.groups.map(a=>a.id===e?{...a,...t}:a)}))},[g]),J=(0,r.useCallback)(e=>{g(t=>{let a=t.groups.find(t=>t.id===e);if(!a||"editable-group"===a.id)return t;let s=a.layerIds,n=t.layers.filter(e=>!s.includes(e.id)).sort((e,t)=>e.zIndex-t.zIndex).map((e,t)=>({...e,zIndex:t})),r=t.groups.filter(t=>t.id!==e);return{...t,layers:n,groups:r,selectedLayers:[]}})},[g]),$=(0,r.useCallback)(e=>{g(t=>{let a={id:(0,i.l)(),name:e,visible:!0,locked:!1,layerIds:[]};return{...t,groups:[...t.groups,a]}})},[g]),F=(0,r.useCallback)((e,t,a)=>{g(s=>{let n;if(s.groups.some(t=>t.id===e))return s;let r=[],i=[...s.layers].sort((e,t)=>t.zIndex-e.zIndex),o=new Set(s.groups.flatMap(e=>e.layerIds));[...s.groups].sort((e,t)=>e.name.localeCompare(t.name)).forEach(e=>{r.push({id:e.id,type:"group"}),i.filter(t=>t.groupId===e.id).forEach(e=>r.push({id:e.id,type:"layer"}))}),r.push({id:"root-delimiter",type:"root-delimiter"}),i.filter(e=>!o.has(e.id)).forEach(e=>r.push({id:e.id,type:"layer"}));let l=r.findIndex(t=>t.id===e);if(-1===l)return s;let[c]=r.splice(l,1);if("root-delimiter"===c.type)return r.splice(l,0,c),s;let d=s.groups.some(e=>e.id===t),h=r.findIndex(e=>e.id===t);-1!==h?"inside"===a&&d?r.splice(h+1,0,c):("after"===a&&h++,r.splice(h,0,c)):r.push(c);let u=r.filter(e=>"layer"===e.type).map(e=>e.id).reverse(),p=new Map;r.forEach(e=>{"group"===e.type?n=e.id:"root-delimiter"===e.type?n=void 0:"layer"===e.type&&p.set(e.id,n)});let m=s.layers.map(e=>({...e,zIndex:u.indexOf(e.id),groupId:p.get(e.id)})),x=s.groups.map(e=>({...e,layerIds:m.filter(t=>t.groupId===e.id).map(e=>e.id)}));return{...s,layers:m,groups:x}})},[g]),O=(0,r.useCallback)(()=>{g(e=>({...e,zoomAction:"fit"}))},[g]),Y=(0,r.useCallback)(e=>{g(t=>{let a=t.canvas.guides.items.filter(t=>t.orientation===e),s="horizontal"===e?t.canvas.height:t.canvas.width,n=0;a.length>0&&(n=Math.max(...a.map(e=>e.position)));let r=n+100;if(r>s)return p({title:"Cannot Add Guide",description:"Not enough space on the canvas to add a new guide."}),t;let o={id:(0,i.l)(),orientation:e,position:r},l=[...t.canvas.guides.items,o];return{...t,canvas:{...t.canvas,guides:{...t.canvas.guides,items:l}}}})},[g,p]),U=(0,r.useCallback)((e,t)=>{g(a=>{let s=a.canvas.guides.items.map(a=>a.id===e?{...a,position:t}:a);return{...a,canvas:{...a.canvas,guides:{...a.canvas.guides,items:s}}}})},[g]),X=(0,r.useCallback)(e=>{g(t=>{let a=t.canvas.guides.items.filter(t=>t.id!==e);return{...t,canvas:{...t.canvas,guides:{...t.canvas.guides,items:a}}}})},[g]),V=(0,r.useCallback)((e,t)=>{g(a=>{if(t<1){let t=a.canvas.guides.items.filter(t=>t.orientation!==e);return{...a,canvas:{...a.canvas,guides:{...a.canvas.guides,items:t}}}}let s=("horizontal"===e?a.canvas.height:a.canvas.width)/(t+1),n=Array.from({length:t},(t,a)=>({id:(0,i.l)(),orientation:e,position:s*(a+1)})),r=[...a.canvas.guides.items.filter(t=>t.orientation!==e),...n];return{...a,canvas:{...a.canvas,guides:{...a.canvas.guides,items:r}}}})},[g]),B=(0,r.useCallback)(()=>{g(e=>({...e,canvas:{...e.canvas,guides:{...e.canvas.guides,snap:!e.canvas.guides.snap}}}))},[g]),K=(0,r.useCallback)((e,t)=>{u({id:e,isActive:!0,onPick:t,previewColor:null})},[]),G=(0,r.useCallback)(e=>{h&&(h.onPick(e),u(null))},[h]),Z=(0,r.useCallback)(e=>{u(t=>t?{...t,previewColor:e}:null)},[]),_=(0,r.useCallback)(async()=>{try{await (0,l.JU)(a.present),p({title:"Project Saved!",description:"Your project has been saved."})}catch(e){console.error("Failed to save project:",e),p({variant:"destructive",title:"Save Failed",description:"Could not save project."})}},[a.present,p]),H=(0,r.useCallback)(async()=>{try{await m(a.present),p({title:"Project Exported!",description:"Your project has been exported as an HTML file."})}catch(e){console.error("Failed to export project:",e),p({variant:"destructive",title:"Export Failed",description:e.message||"Could not export your project."})}},[a.present,p]),W=(0,r.useCallback)(async e=>{try{let t=await (0,l.U1)(e);t?(s({past:[],present:t,future:[]}),p({title:"Project Loaded"})):p({variant:"destructive",title:"Load Failed",description:"Could not find project."})}catch(e){console.error("Failed to load project:",e),p({variant:"destructive",title:"Load Failed",description:"Could not load project."})}},[p]);return(0,n.jsx)(x.Provider,{value:{project:a.present,setProject:g,setProjectLive:v,commitHistory:y,undo:j,redo:w,canUndo:c,canRedo:d,setActiveTool:b,setSelectedShape:N,addImageLayer:C,setSelectedLayers:k,toggleCropMode:I,updateLayer:M,deleteLayers:z,duplicateLayers:A,moveLayer:S,alignLayers:L,bringToFront:E,sendToBack:D,groupLayers:T,ungroupLayers:R,updateGroup:P,deleteGroup:J,addNewGroup:$,handleLayerDrop:F,zoomToFit:O,addGuide:Y,updateGuide:U,removeGuide:X,generateGuides:V,toggleSnapping:B,eyedropper:h,activateEyedropper:K,finishEyedropper:G,setEyedropperPreview:Z,toast:p,saveProject:_,exportProject:H,loadProject:W},children:t})},v=()=>{let e=r.useContext(x);if(void 0===e)throw Error("useEditor must be used within an EditorProvider");return e}},6447:(e,t,a)=>{"use strict";function s(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}a.d(t,{l:()=>s})},7188:(e,t,a)=>{"use strict";a.d(t,{default:()=>F});var s=a(3424),n=a(3884),r=a(5114),i=a(7602),o=a(9257);let l=n.forwardRef((e,t)=>{let{className:a,orientation:n="horizontal",decorative:r=!0,...l}=e;return(0,s.jsx)(i.b,{ref:t,decorative:r,orientation:n,className:(0,o.cn)("shrink-0 bg-border","horizontal"===n?"h-[1px] w-full":"h-full w-[1px]",a),...l})});l.displayName=i.b.displayName;var c=a(6418),d=a(7692),h=a(4259),u=a(4848),p=a(6871),m=a(8361),x=a(7305),f=a(6099),g=a(7050),v=a(4990),y=a(7431);let j=y.bL,w=y.l9,b=y.ZL,N=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(y.hJ,{className:(0,o.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...n,ref:t})});N.displayName=y.hJ.displayName;let C=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsxs)(b,{children:[(0,s.jsx)(N,{}),(0,s.jsx)(y.UC,{ref:t,className:(0,o.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...n})]})});C.displayName=y.UC.displayName;let k=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,o.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})};k.displayName="AlertDialogHeader";let I=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,o.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};I.displayName="AlertDialogFooter";let M=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(y.hE,{ref:t,className:(0,o.cn)("text-lg font-semibold",a),...n})});M.displayName=y.hE.displayName;let z=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(y.VY,{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",a),...n})});z.displayName=y.VY.displayName;let A=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(y.rc,{ref:t,className:(0,o.cn)((0,r.r)(),a),...n})});A.displayName=y.rc.displayName;let S=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(y.ZD,{ref:t,className:(0,o.cn)((0,r.r)({variant:"outline"}),"mt-2 sm:mt-0",a),...n})});S.displayName=y.ZD.displayName;var L=a(7795),E=a(5923),D=a(3966),T=a(5035);let R=n.forwardRef((e,t)=>{let{className:a,children:n,...r}=e;return(0,s.jsxs)(T.bL,{ref:t,className:(0,o.cn)("relative overflow-hidden",a),...r,children:[(0,s.jsx)(T.LM,{className:"h-full w-full rounded-[inherit]",children:n}),(0,s.jsx)(P,{}),(0,s.jsx)(T.OK,{})]})});R.displayName=T.bL.displayName;let P=n.forwardRef((e,t)=>{let{className:a,orientation:n="vertical",...r}=e;return(0,s.jsx)(T.VM,{ref:t,orientation:n,className:(0,o.cn)("flex touch-none select-none transition-colors","vertical"===n&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===n&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...r,children:(0,s.jsx)(T.lr,{className:"relative flex-1 rounded-full bg-border"})})});P.displayName=T.VM.displayName;var J=a(2947);function $(e){let{children:t,open:a,onOpenChange:i}=e,{loadProject:o,toast:l}=(0,c.h)(),[d,h]=(0,n.useState)([]),[u,p]=(0,n.useState)(!1),m=async()=>{p(!0);try{let e=await (0,L.JQ)();h(e)}catch(e){console.error(e),l({variant:"destructive",title:"Failed to load projects"})}finally{p(!1)}};(0,n.useEffect)(()=>{a&&m()},[a]);let x=async e=>{try{await (0,L.xx)(e),l({title:"Project Deleted"}),m()}catch(e){console.error(e),l({variant:"destructive",title:"Delete Failed"})}};return(0,s.jsxs)(v.lG,{open:a,onOpenChange:i,children:[(0,s.jsx)(v.zM,{asChild:!0,children:t}),(0,s.jsxs)(v.Cf,{className:"sm:max-w-4xl",children:[(0,s.jsxs)(v.c7,{children:[(0,s.jsx)(v.L3,{children:"Load Project"}),(0,s.jsx)(v.rr,{children:"Select a project saved in your browser to continue editing."})]}),(0,s.jsx)(R,{className:"h-[60vh] pr-4",children:u?(0,s.jsx)("div",{className:"text-center text-muted-foreground py-10",children:"Loading projects..."}):(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 py-4",children:d.length>0?d.map(e=>(0,s.jsxs)("div",{className:"border rounded-lg overflow-hidden flex flex-col group",children:[(0,s.jsx)("div",{className:"aspect-video bg-muted relative",children:e.meta.thumbnail?(0,s.jsx)(D.default,{src:e.meta.thumbnail,alt:e.meta.name,layout:"fill",objectFit:"cover"}):(0,s.jsx)("div",{className:"flex items-center justify-center h-full text-muted-foreground text-xs",children:"No preview"})}),(0,s.jsxs)("div",{className:"p-4 flex-1 flex flex-col",children:[(0,s.jsx)("h3",{className:"font-semibold truncate",children:e.meta.name}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Updated ",e.meta.updatedAt?(0,J.m)(new Date(e.meta.updatedAt),{addSuffix:!0}):"a while ago"]}),(0,s.jsxs)("div",{className:"mt-4 flex items-center gap-2 pt-4 border-t",children:[(0,s.jsx)(r.$,{size:"sm",className:"flex-1",onClick:()=>{o(e.meta.id),i(!1)},children:"Load"}),(0,s.jsxs)(j,{children:[(0,s.jsx)(w,{asChild:!0,children:(0,s.jsx)(r.$,{variant:"destructive",size:"icon",children:(0,s.jsx)(E.A,{})})}),(0,s.jsxs)(C,{children:[(0,s.jsxs)(k,{children:[(0,s.jsx)(M,{children:"Are you sure?"}),(0,s.jsx)(z,{children:"This action cannot be undone. This will permanently delete the project from your browser."})]}),(0,s.jsxs)(I,{children:[(0,s.jsx)(S,{children:"Cancel"}),(0,s.jsx)(A,{onClick:()=>x(e.meta.id),children:"Delete"})]})]})]})]})]})]},e.meta.id)):(0,s.jsx)("div",{className:"col-span-full text-center text-muted-foreground py-10",children:"No saved projects found in this browser."})})}),(0,s.jsx)(v.Es,{children:(0,s.jsx)(r.$,{variant:"outline",onClick:()=>i(!1),children:"Close"})})]})]})}function F(){let{project:e,setProject:t,zoomToFit:a,undo:i,redo:o,canUndo:v,canRedo:y,toggleSnapping:j,saveProject:w,exportProject:b}=(0,c.h)(),[N,C]=(0,n.useState)(!1),k=e=>{t(t=>{let a=t.zoom*e;return{...t,zoom:Math.max(.02,Math.min(a,16))}})};return(0,s.jsxs)("header",{className:"shrink-0 h-14 px-4 flex items-center justify-between border-b bg-card",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("h1",{className:"text-lg font-bold font-headline",children:"Mukysart Studio"}),(0,s.jsx)(l,{orientation:"vertical",className:"h-6"}),(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:e.meta.name})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(r.$,{variant:"ghost",size:"icon","aria-label":"Zoom Out",onClick:()=>k(1/1.2),children:(0,s.jsx)(d.A,{})}),(0,s.jsxs)(r.$,{variant:"ghost",size:"sm",className:"w-20",onClick:a,children:[Math.round(100*e.zoom),"%"]}),(0,s.jsx)(r.$,{variant:"ghost",size:"icon","aria-label":"Zoom In",onClick:()=>k(1.2),children:(0,s.jsx)(h.A,{})}),(0,s.jsx)(l,{orientation:"vertical",className:"h-6"}),(0,s.jsx)(r.$,{variant:e.canvas.guides.snap?"secondary":"ghost",size:"icon","aria-label":"Toggle Snapping",onClick:j,children:(0,s.jsx)(u.A,{})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(r.$,{variant:"ghost",size:"icon","aria-label":"Undo",onClick:i,disabled:!v,children:(0,s.jsx)(p.A,{})}),(0,s.jsx)(r.$,{variant:"ghost",size:"icon","aria-label":"Redo",onClick:o,disabled:!y,children:(0,s.jsx)(m.A,{})}),(0,s.jsx)(l,{orientation:"vertical",className:"h-6"}),(0,s.jsx)($,{open:N,onOpenChange:C,children:(0,s.jsxs)(r.$,{variant:"ghost",size:"sm",children:[(0,s.jsx)(x.A,{className:"mr-2"}),"Load"]})}),(0,s.jsxs)(r.$,{variant:"ghost",size:"sm",onClick:w,children:[(0,s.jsx)(f.A,{className:"mr-2"}),"Save"]}),(0,s.jsxs)(r.$,{size:"sm",onClick:b,children:[(0,s.jsx)(g.A,{className:"mr-2"}),"Export"]})]})]})}},7795:(e,t,a)=>{"use strict";a.d(t,{xx:()=>p,U1:()=>u,JQ:()=>h,JU:()=>d});var s={};a.r(s),a.d(s,{deleteProject:()=>c,getProject:()=>l,getProjects:()=>o,saveProject:()=>i});var n=a(9947),r=a.n(n);let i=async e=>{let t=document.getElementById("canvas-area");if(!t)throw Error("Could not find canvas area to generate thumbnail.");let a=(await r()(t,{useCORS:!0,backgroundColor:null,scale:200/Math.max(t.offsetWidth,1)})).toDataURL("image/jpeg",.7),s={...e,meta:{...e.meta,thumbnail:a,updatedAt:new Date().toISOString()}};if(!(await fetch("/api/projects/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).ok)throw Error("Failed to save project on the server.")},o=async()=>{let e=await fetch("/api/projects");if(!e.ok)throw Error("Failed to get projects from the server.");return(await e.json()).sort((e,t)=>new Date(t.meta.updatedAt).getTime()-new Date(e.meta.updatedAt).getTime())},l=async e=>{let t=await fetch("/api/projects/".concat(e));if(!t.ok){if(404===t.status)return;throw Error("Failed to get project from the server.")}return await t.json()},c=async e=>{if(!(await fetch("/api/projects/".concat(e),{method:"DELETE"})).ok)throw Error("Failed to delete project on the server.")},d=s.saveProject,h=s.getProjects,u=s.getProject,p=s.deleteProject},8066:(e,t,a)=>{"use strict";a.d(t,{default:()=>eM});var s=a(3424),n=a(3884),r=a(9399),i=a(9257);let o=r.bL,l=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(r.B8,{ref:t,className:(0,i.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...n})});l.displayName=r.B8.displayName;let c=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(r.l9,{ref:t,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...n})});c.displayName=r.l9.displayName;let d=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(r.UC,{ref:t,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...n})});d.displayName=r.UC.displayName;var h=a(6418),u=a(3360),p=a(3226);let m=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...n})});m.displayName="Textarea";var x=a(5880),f=a(9168),g=a(5609),v=a(5610);let y=x.bL;x.YJ;let j=x.WT,w=n.forwardRef((e,t)=>{let{className:a,children:n,...r}=e;return(0,s.jsxs)(x.l9,{ref:t,className:(0,i.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...r,children:[n,(0,s.jsx)(x.In,{asChild:!0,children:(0,s.jsx)(f.A,{className:"h-4 w-4 opacity-50"})})]})});w.displayName=x.l9.displayName;let b=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(x.PP,{ref:t,className:(0,i.cn)("flex cursor-default items-center justify-center py-1",a),...n,children:(0,s.jsx)(g.A,{className:"h-4 w-4"})})});b.displayName=x.PP.displayName;let N=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(x.wn,{ref:t,className:(0,i.cn)("flex cursor-default items-center justify-center py-1",a),...n,children:(0,s.jsx)(f.A,{className:"h-4 w-4"})})});N.displayName=x.wn.displayName;let C=n.forwardRef((e,t)=>{let{className:a,children:n,position:r="popper",...o}=e;return(0,s.jsx)(x.ZL,{children:(0,s.jsxs)(x.UC,{ref:t,className:(0,i.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:r,...o,children:[(0,s.jsx)(b,{}),(0,s.jsx)(x.LM,{className:(0,i.cn)("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),(0,s.jsx)(N,{})]})})});C.displayName=x.UC.displayName,n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(x.JU,{ref:t,className:(0,i.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...n})}).displayName=x.JU.displayName;let k=n.forwardRef((e,t)=>{let{className:a,children:n,...r}=e;return(0,s.jsxs)(x.q7,{ref:t,className:(0,i.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...r,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(x.VF,{children:(0,s.jsx)(v.A,{className:"h-4 w-4"})})}),(0,s.jsx)(x.p4,{children:n})]})});k.displayName=x.q7.displayName,n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(x.wv,{ref:t,className:(0,i.cn)("-mx-1 my-1 h-px bg-muted",a),...n})}).displayName=x.wv.displayName;var I=a(2740);let M=I.bL,z=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(I.q7,{ref:t,className:(0,i.cn)("border-b",a),...n})});z.displayName="AccordionItem";let A=n.forwardRef((e,t)=>{let{className:a,children:n,...r}=e;return(0,s.jsx)(I.Y9,{className:"flex",children:(0,s.jsxs)(I.l9,{ref:t,className:(0,i.cn)("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",a),...r,children:[n,(0,s.jsx)(f.A,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})})});A.displayName=I.l9.displayName;let S=n.forwardRef((e,t)=>{let{className:a,children:n,...r}=e;return(0,s.jsx)(I.UC,{ref:t,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...r,children:(0,s.jsx)("div",{className:(0,i.cn)("pb-4 pt-0",a),children:n})})});S.displayName=I.UC.displayName;var L=a(5253);let E=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsxs)(L.bL,{ref:t,className:(0,i.cn)("relative flex w-full touch-none select-none items-center",a),...n,children:[(0,s.jsx)(L.CC,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:(0,s.jsx)(L.Q6,{className:"absolute h-full bg-primary"})}),(0,s.jsx)(L.zi,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]})});E.displayName=L.bL.displayName;var D=a(5114),T=a(5923),R=a(3605),P=a(9829),J=a(4514),$=a(9926),F=a(2469),O=a(1140),Y=a(3465),U=a(9092),X=a(8185);let V=X.bL,B=X.l9,K=n.forwardRef((e,t)=>{let{className:a,align:n="center",sideOffset:r=4,...o}=e;return(0,s.jsx)(X.ZL,{children:(0,s.jsx)(X.UC,{ref:t,align:n,sideOffset:r,className:(0,i.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...o})})});K.displayName=X.UC.displayName;var G=a(6447),Z=a(7416);let _=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(Z.bL,{className:(0,i.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a),...n,ref:t,children:(0,s.jsx)(Z.zi,{className:(0,i.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});_.displayName=Z.bL.displayName;var H=a(7970),W=a(2579),q=a(3191),Q=a(6348),ee=a(9525),et=a(8733),ea=a(5486),es=a(6757),en=a(7675),er=a(8611);function ei(){let{project:e,alignLayers:t,bringToFront:a,sendToBack:n,duplicateLayers:r,deleteLayers:i}=(0,h.h)(),{selectedLayers:o}=e;return(0,s.jsx)(er.Bc,{children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-1 p-1 border rounded-lg",children:[(0,s.jsxs)(er.m_,{children:[(0,s.jsx)(er.k$,{asChild:!0,children:(0,s.jsx)(D.$,{variant:"ghost",size:"icon",onClick:()=>t("left"),children:(0,s.jsx)(H.A,{})})}),(0,s.jsx)(er.ZI,{children:"Align Left"})]}),(0,s.jsxs)(er.m_,{children:[(0,s.jsx)(er.k$,{asChild:!0,children:(0,s.jsx)(D.$,{variant:"ghost",size:"icon",onClick:()=>t("center"),children:(0,s.jsx)(W.A,{})})}),(0,s.jsx)(er.ZI,{children:"Align Center"})]}),(0,s.jsxs)(er.m_,{children:[(0,s.jsx)(er.k$,{asChild:!0,children:(0,s.jsx)(D.$,{variant:"ghost",size:"icon",onClick:()=>t("right"),children:(0,s.jsx)(q.A,{})})}),(0,s.jsx)(er.ZI,{children:"Align Right"})]}),(0,s.jsxs)(er.m_,{children:[(0,s.jsx)(er.k$,{asChild:!0,children:(0,s.jsx)(D.$,{variant:"ghost",size:"icon",onClick:()=>t("top"),children:(0,s.jsx)(Q.A,{})})}),(0,s.jsx)(er.ZI,{children:"Align Top"})]}),(0,s.jsxs)(er.m_,{children:[(0,s.jsx)(er.k$,{asChild:!0,children:(0,s.jsx)(D.$,{variant:"ghost",size:"icon",onClick:()=>t("middle"),children:(0,s.jsx)(ee.A,{})})}),(0,s.jsx)(er.ZI,{children:"Align Middle"})]}),(0,s.jsxs)(er.m_,{children:[(0,s.jsx)(er.k$,{asChild:!0,children:(0,s.jsx)(D.$,{variant:"ghost",size:"icon",onClick:()=>t("bottom"),children:(0,s.jsx)(et.A,{})})}),(0,s.jsx)(er.ZI,{children:"Align Bottom"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-1 p-1 border rounded-lg",children:[(0,s.jsxs)(er.m_,{children:[(0,s.jsx)(er.k$,{asChild:!0,children:(0,s.jsx)(D.$,{variant:"ghost",size:"icon",onClick:()=>a(),children:(0,s.jsx)(ea.A,{})})}),(0,s.jsx)(er.ZI,{children:"Bring to Front"})]}),(0,s.jsxs)(er.m_,{children:[(0,s.jsx)(er.k$,{asChild:!0,children:(0,s.jsx)(D.$,{variant:"ghost",size:"icon",onClick:()=>n(),children:(0,s.jsx)(es.A,{})})}),(0,s.jsx)(er.ZI,{children:"Send to Back"})]}),(0,s.jsxs)(er.m_,{children:[(0,s.jsx)(er.k$,{asChild:!0,children:(0,s.jsx)(D.$,{variant:"ghost",size:"icon",onClick:()=>{r(o)},children:(0,s.jsx)(en.A,{})})}),(0,s.jsx)(er.ZI,{children:"Duplicate"})]}),(0,s.jsxs)(er.m_,{children:[(0,s.jsx)(er.k$,{asChild:!0,children:(0,s.jsx)(D.$,{variant:"ghost",size:"icon",className:"text-destructive hover:text-destructive",onClick:()=>{i(o)},children:(0,s.jsx)(T.A,{})})}),(0,s.jsx)(er.ZI,{children:"Delete"})]})]})]})})}var eo=a(1568),el=a(8661);function ec(e,t,a){let s=t.split("."),n={...e},r=n;for(let e=0;e<s.length-1;e++){let t=s[e];r[t]={...r[t]},r=r[t]}return r[s[s.length-1]]=a,n}function ed(e){let{value:t,onChange:a,onCommit:n,...r}=e,i=e=>{a(t+e)};return(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(p.p,{type:"number",value:t,onChange:e=>{if(""===e.target.value||"-"===e.target.value)return void a(0);let t=parseInt(e.target.value,10);isNaN(t)||a(t)},onBlur:n,className:"[appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none h-10",...r}),(0,s.jsxs)("div",{className:"flex flex-col border bg-background rounded-md overflow-hidden",children:[(0,s.jsx)("button",{tabIndex:-1,onClick:()=>i(1),onMouseUp:n,className:"flex h-5 w-6 items-center justify-center text-muted-foreground hover:bg-muted/50 hover:text-foreground",children:(0,s.jsx)(g.A,{className:"h-4 w-4"})}),(0,s.jsx)("div",{className:"h-px bg-border w-full"}),(0,s.jsx)("button",{tabIndex:-1,onClick:()=>i(-1),onMouseUp:n,className:"flex h-5 w-6 items-center justify-center text-muted-foreground hover:bg-muted/50 hover:text-foreground",children:(0,s.jsx)(f.A,{className:"h-4 w-4"})})]})]})}function eh(e){let{color:t,onChange:a,enableTransparent:r=!1}=e,{project:m,activateEyedropper:x,eyedropper:f,finishEyedropper:g}=(0,h.h)(),v=(0,n.useId)(),b=(null==f?void 0:f.isActive)&&f.id===v,N=n.useMemo(()=>{let e={type:"solid",mode:"mapped",value:"primary"};return t?t.type?t:{...e,...t}:e},[t]),[I,M]=(0,n.useState)(N.type);(0,n.useEffect)(()=>{M(N.type)},[N.type]);let z=()=>{if("solid"===N.type)return"mapped"===N.mode&&m.colors[N.value]||N.value;if("linear"===N.type||"radial"===N.type){var e;return(null==(e=N.stops[0])?void 0:e.color)||"#000000"}return"#000000"},A=(e,t)=>{if("linear"===N.type||"radial"===N.type){let s=N.stops.map(a=>a.id===e?{...a,...t}:a);a({...N,stops:s})}},S=()=>{if("linear"===N.type||"radial"===N.type){let e={id:(0,G.l)(),color:"#ffffff",position:50},t=[...N.stops,e].sort((e,t)=>e.position-t.position);a({...N,stops:t})}},L=e=>{if("linear"===N.type||"radial"===N.type){if(N.stops.length<=2)return;let t=N.stops.filter(t=>t.id!==e);a({...N,stops:t})}},P=e=>{"custom"===e.mode&&e.value.length>7&&(e.value=e.value.substring(0,7)),a(e)},J=b&&f.previewColor?f.previewColor:"solid"===N.type?z():"linear"===N.type?"linear-gradient(".concat(N.angle,"deg, ").concat(N.stops.map(e=>"".concat(e.color," ").concat(e.position,"%")).join(", "),")"):"radial"===N.type?"radial-gradient(".concat(N.shape,", ").concat(N.stops.map(e=>"".concat(e.color," ").concat(e.position,"%")).join(", "),")"):"hsl(var(--muted))",$=b&&f.previewColor?f.previewColor:"solid"===N.type?z():"".concat(N.type," gradient");return(0,s.jsx)("div",{className:"space-y-4",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(V,{children:[(0,s.jsx)(B,{asChild:!0,children:(0,s.jsx)(D.$,{variant:"outline",className:"h-10 w-10 p-0 border",children:(0,s.jsx)("div",{className:"w-full h-full rounded-sm checkerboard",children:(0,s.jsx)("div",{className:"w-full h-full rounded-sm",style:{background:J}})})})}),(0,s.jsx)(K,{className:"w-auto p-0",children:(0,s.jsxs)(o,{value:I,onValueChange:e=>{e!==N.type&&(M(e),"solid"===e?a({type:"solid",mode:"mapped",value:"primary"}):"linear"===e?a({type:"linear",angle:90,stops:[{id:(0,G.l)(),color:m.colors.primary,position:0},{id:(0,G.l)(),color:m.colors.accent,position:100}]}):"radial"===e&&a({type:"radial",shape:"ellipse",stops:[{id:(0,G.l)(),color:m.colors.primary,position:0},{id:(0,G.l)(),color:m.colors.accent,position:100}]}))},className:"w-full",children:[(0,s.jsxs)(l,{className:"grid w-full grid-cols-3 rounded-b-none",children:[(0,s.jsx)(c,{value:"solid",children:"Solid"}),(0,s.jsx)(c,{value:"linear",children:"Linear"}),(0,s.jsx)(c,{value:"radial",children:"Radial"})]}),(0,s.jsx)(d,{value:"solid",className:"p-2 space-y-2 mt-0",children:"solid"===N.type&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:"text-xs font-medium text-muted-foreground px-1",children:"Theme Colors"}),(0,s.jsx)("div",{className:"flex gap-1",children:Object.keys(m.colors).map(e=>(0,s.jsx)(D.$,{variant:"outline",className:(0,i.cn)("h-8 w-8 p-0 border","mapped"===N.mode&&N.value===e&&"ring-2 ring-ring"),onClick:()=>P({type:"solid",mode:"mapped",value:e}),children:(0,s.jsx)("div",{className:"w-full h-full rounded-sm",style:{backgroundColor:m.colors[e]}})},e))}),(0,s.jsx)("p",{className:"text-xs font-medium text-muted-foreground px-1 pt-2",children:"Custom Color"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(p.p,{type:"color",value:"custom"===N.mode?N.value:"#000000",onChange:e=>P({type:"solid",mode:"custom",value:e.target.value}),className:"w-10 h-10 p-1"}),(0,s.jsx)(p.p,{value:"custom"===N.mode?N.value:"",placeholder:"#000000",onChange:e=>P({type:"solid",mode:"custom",value:e.target.value}),onFocus:()=>{"mapped"===N.mode&&P({type:"solid",mode:"custom",value:z()})}})]}),r&&(0,s.jsx)(D.$,{variant:"outline",size:"sm",onClick:()=>P({type:"solid",mode:"custom",value:"transparent"}),children:"Set Transparent"})]})}),(0,s.jsx)(d,{value:"linear",className:"p-2 space-y-4 mt-0",children:"linear"===N.type&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Angle"}),(0,s.jsx)(E,{value:[N.angle],onValueChange:e=>{let[t]=e;return a({...N,angle:t})},min:0,max:360,step:1})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Stops"}),(0,s.jsx)("div",{className:"space-y-2 mt-1",children:N.stops.map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(V,{children:[(0,s.jsx)(B,{asChild:!0,children:(0,s.jsx)(D.$,{variant:"outline",className:"h-8 w-8 p-0 border",children:(0,s.jsx)("div",{className:"w-full h-full rounded-sm",style:{backgroundColor:e.color}})})}),(0,s.jsx)(K,{className:"w-auto p-0",children:(0,s.jsx)(p.p,{type:"color",value:e.color,onChange:t=>A(e.id,{color:t.target.value}),className:"w-24 h-24 p-1"})})]}),(0,s.jsx)(p.p,{className:"h-8",type:"text",value:e.color,onChange:t=>A(e.id,{color:t.target.value})}),(0,s.jsx)(ed,{className:"h-8 w-16",value:e.position,onChange:t=>A(e.id,{position:t})}),(0,s.jsx)(D.$,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>L(e.id),children:(0,s.jsx)(T.A,{className:"h-4 w-4"})})]},e.id))}),(0,s.jsx)(D.$,{variant:"outline",size:"sm",className:"mt-2 w-full",onClick:S,children:"Add Stop"})]})]})}),(0,s.jsx)(d,{value:"radial",className:"p-2 space-y-4 mt-0",children:"radial"===N.type&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Shape"}),(0,s.jsxs)(y,{value:N.shape,onValueChange:e=>a({...N,shape:e}),children:[(0,s.jsx)(w,{children:(0,s.jsx)(j,{})}),(0,s.jsxs)(C,{children:[(0,s.jsx)(k,{value:"circle",children:"Circle"}),(0,s.jsx)(k,{value:"ellipse",children:"Ellipse"})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Stops"}),(0,s.jsx)("div",{className:"space-y-2 mt-1",children:N.stops.map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(V,{children:[(0,s.jsx)(B,{asChild:!0,children:(0,s.jsx)(D.$,{variant:"outline",className:"h-8 w-8 p-0 border",children:(0,s.jsx)("div",{className:"w-full h-full rounded-sm",style:{backgroundColor:e.color}})})}),(0,s.jsx)(K,{className:"w-auto p-0",children:(0,s.jsx)(p.p,{type:"color",value:e.color,onChange:t=>A(e.id,{color:t.target.value}),className:"w-24 h-24 p-1"})})]}),(0,s.jsx)(p.p,{className:"h-8",type:"text",value:e.color,onChange:t=>A(e.id,{color:t.target.value})}),(0,s.jsx)(ed,{className:"h-8 w-16",value:e.position,onChange:t=>A(e.id,{position:t})}),(0,s.jsx)(D.$,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>L(e.id),children:(0,s.jsx)(T.A,{className:"h-4 w-4"})})]},e.id))}),(0,s.jsx)(D.$,{variant:"outline",size:"sm",className:"mt-2 w-full",onClick:S,children:"Add Stop"})]})]})})]})})]}),(0,s.jsx)(p.p,{value:$,className:"flex-1",readOnly:"solid"!==N.type||b,onChange:e=>{"solid"===N.type&&a({type:"solid",mode:"custom",value:e.target.value})}}),(0,s.jsx)(D.$,{variant:b?"secondary":"outline",size:"icon",className:"h-10 w-10",onClick:()=>{if(b)return void g(null);x(v,e=>{e&&a({type:"solid",mode:"custom",value:e})})},children:(0,s.jsx)(R.A,{className:"h-5 w-5"})})]})})}function eu(e){let{layer:t}=e,{project:a,setProject:r,setProjectLive:i,commitHistory:o}=(0,h.h)(),[l,c]=(0,n.useState)(null),d=(e,a)=>{r(s=>({...s,layers:s.layers.map(s=>s.id===t.id?ec(s,e,a):s)}))},x=(e,s)=>{l||c(a),i(a=>({...a,layers:a.layers.map(a=>a.id===t.id?ec(a,e,s):a)}))},f=()=>{l&&(o(l,a),c(null))},g=()=>{l||c(a)};return(0,s.jsx)("div",{className:"space-y-4",children:(0,s.jsxs)(M,{type:"multiple",defaultValue:["content","color","transform","font"],className:"w-full",children:[(0,s.jsxs)(z,{value:"content",children:[(0,s.jsx)(A,{className:"text-sm font-medium",children:"Content"}),(0,s.jsx)(S,{children:(0,s.jsx)(m,{value:t.content,onChange:e=>d("content",e.target.value),className:"mt-1"})})]}),(0,s.jsxs)(z,{value:"color",children:[(0,s.jsx)(A,{className:"text-sm font-medium",children:"Color"}),(0,s.jsx)(S,{children:(0,s.jsx)(eh,{color:t.color,onChange:e=>d("color",e)})})]}),(0,s.jsxs)(z,{value:"transform",children:[(0,s.jsx)(A,{className:"text-sm font-medium",children:"Transform"}),(0,s.jsx)(S,{children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"X"}),(0,s.jsx)(ed,{value:Math.round(t.transform.x),onChange:e=>x("transform.x",e),onCommit:f})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Y"}),(0,s.jsx)(ed,{value:Math.round(t.transform.y),onChange:e=>x("transform.y",e),onCommit:f})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Width"}),(0,s.jsx)(ed,{value:Math.round(t.transform.width),onChange:e=>x("transform.width",Math.max(10,e)),onCommit:f})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Height"}),(0,s.jsx)(ed,{value:Math.round(t.transform.height),onChange:e=>x("transform.height",Math.max(10,e)),onCommit:f})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Rotation"}),(0,s.jsx)(ed,{value:Math.round(t.transform.rotation),onChange:e=>x("transform.rotation",e),onCommit:f})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(u.J,{children:["Opacity: ",Math.round(100*t.transform.opacity),"%"]}),(0,s.jsx)("div",{onMouseDown:g,onMouseUp:f,children:(0,s.jsx)(E,{value:[t.transform.opacity],onValueChange:e=>{let[t]=e;return x("transform.opacity",t)},min:0,max:1,step:.01})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(u.J,{children:["Blur: ",Math.round(t.transform.blur||0),"px"]}),(0,s.jsx)("div",{onMouseDown:g,onMouseUp:f,children:(0,s.jsx)(E,{value:[t.transform.blur||0],onValueChange:e=>{let[t]=e;return x("transform.blur",t)},min:0,max:100,step:1})})]})]})})]}),(0,s.jsxs)(z,{value:"font",children:[(0,s.jsx)(A,{className:"text-sm font-medium",children:"Typography"}),(0,s.jsx)(S,{children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Font Family"}),(0,s.jsxs)(y,{value:t.font.family,onValueChange:e=>d("font.family",e),children:[(0,s.jsx)(w,{children:(0,s.jsx)(j,{placeholder:"Font Family"})}),(0,s.jsx)(C,{children:el.Tj.map(e=>(0,s.jsx)(k,{value:e,style:{fontFamily:e},children:e},e))})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsx)(ed,{value:t.font.size,onChange:e=>x("font.size",Math.max(1,e)),onCommit:f,placeholder:"Size"}),(0,s.jsxs)(y,{value:t.font.align,onValueChange:e=>d("font.align",e),children:[(0,s.jsx)(w,{children:(0,s.jsx)(j,{placeholder:"Alignment"})}),(0,s.jsxs)(C,{children:[(0,s.jsx)(k,{value:"left",children:"Left"}),(0,s.jsx)(k,{value:"center",children:"Center"}),(0,s.jsx)(k,{value:"right",children:"Right"})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(D.$,{variant:t.font.weight>400?"secondary":"outline",size:"icon",onClick:()=>d("font.weight",t.font.weight>400?400:700),children:(0,s.jsx)(P.A,{className:"h-4 w-4"})}),(0,s.jsx)(D.$,{variant:"italic"===t.font.style?"secondary":"outline",size:"icon",onClick:()=>d("font.style","italic"===t.font.style?"normal":"italic"),children:(0,s.jsx)(J.A,{className:"h-4 w-4"})}),(0,s.jsx)(D.$,{variant:"underline"===t.font.decoration?"secondary":"outline",size:"icon",onClick:()=>d("font.decoration","underline"===t.font.decoration?"none":"underline"),children:(0,s.jsx)($.A,{className:"h-4 w-4"})}),(0,s.jsx)(D.$,{variant:"line-through"===t.font.decoration?"secondary":"outline",size:"icon",onClick:()=>d("font.decoration","line-through"===t.font.decoration?"none":"line-through"),children:(0,s.jsx)(F.A,{className:"h-4 w-4"})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(u.J,{children:["Line Height: ",t.font.lineHeight.toFixed(1)]}),(0,s.jsx)("div",{onMouseDown:g,onMouseUp:f,children:(0,s.jsx)(E,{value:[t.font.lineHeight],onValueChange:e=>{let[t]=e;return x("font.lineHeight",t)},min:.5,max:3,step:.1})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(u.J,{children:["Letter Spacing: ",t.font.letterSpacing.toFixed(1)]}),(0,s.jsx)("div",{onMouseDown:g,onMouseUp:f,children:(0,s.jsx)(E,{value:[t.font.letterSpacing],onValueChange:e=>{let[t]=e;return x("font.letterSpacing",t)},min:-5,max:20,step:.1})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(u.J,{children:["Padding: ",(t.padding||0).toFixed(0),"px"]}),(0,s.jsx)("div",{onMouseDown:g,onMouseUp:f,children:(0,s.jsx)(E,{value:[t.padding||0],onValueChange:e=>{let[t]=e;return x("padding",t)},min:0,max:100,step:1})})]})]})})]}),(0,s.jsxs)(z,{value:"shadow",children:[(0,s.jsx)(A,{className:"text-sm font-medium",children:"Shadow"}),(0,s.jsx)(S,{children:t.font.shadow?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(p.p,{type:"color",value:t.font.shadow.color,onChange:e=>d("font.shadow.color",e.target.value),className:"w-10 h-10 p-1"}),(0,s.jsx)(p.p,{value:t.font.shadow.color,onChange:e=>d("font.shadow.color",e.target.value)})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(u.J,{children:["Blur: ",t.font.shadow.blur,"px"]}),(0,s.jsx)("div",{onMouseDown:g,onMouseUp:f,children:(0,s.jsx)(E,{value:[t.font.shadow.blur],onValueChange:e=>{let[t]=e;return x("font.shadow.blur",t)},min:0,max:50,step:1})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Offset X"}),(0,s.jsx)(ed,{value:t.font.shadow.offsetX,onChange:e=>x("font.shadow.offsetX",e),onCommit:f})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Offset Y"}),(0,s.jsx)(ed,{value:t.font.shadow.offsetY,onChange:e=>x("font.shadow.offsetY",e),onCommit:f})]})]}),(0,s.jsx)(D.$,{variant:"outline",size:"sm",onClick:()=>d("font.shadow",null),children:"Remove Shadow"})]}):(0,s.jsx)(D.$,{onClick:()=>d("font.shadow",{color:"#000000",blur:5,offsetX:5,offsetY:5}),children:"Add Shadow"})})]}),(0,s.jsxs)(z,{value:"outline",children:[(0,s.jsx)(A,{className:"text-sm font-medium",children:"Outline"}),(0,s.jsx)(S,{children:t.font.outline?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(p.p,{type:"color",value:t.font.outline.color,onChange:e=>d("font.outline.color",e.target.value),className:"w-10 h-10 p-1"}),(0,s.jsx)(p.p,{value:t.font.outline.color,onChange:e=>d("font.outline.color",e.target.value)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Width"}),(0,s.jsx)("div",{onMouseDown:g,onMouseUp:f,children:(0,s.jsx)(E,{value:[t.font.outline.width],onValueChange:e=>{let[t]=e;return x("font.outline.width",t)},min:0,max:10,step:.5})})]}),(0,s.jsx)(D.$,{variant:"outline",size:"sm",onClick:()=>d("font.outline",null),children:"Remove Outline"})]}):(0,s.jsx)(D.$,{onClick:()=>d("font.outline",{color:"#000000",width:1}),children:"Add Outline"})})]}),(0,s.jsxs)(z,{value:"curve",children:[(0,s.jsx)(A,{className:"text-sm font-medium",children:"Curve"}),(0,s.jsx)(S,{children:t.font.curve?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(u.J,{children:["Bend: ",t.font.curve.amount.toFixed(0)]}),(0,s.jsx)("div",{onMouseDown:g,onMouseUp:f,children:(0,s.jsx)(E,{value:[t.font.curve.amount],onValueChange:e=>{let[t]=e;return x("font.curve.amount",t)},min:-100,max:100,step:1})})]}),(0,s.jsx)(D.$,{variant:"outline",size:"sm",onClick:()=>d("font.curve",null),children:"Remove Curve"})]}):(0,s.jsx)(D.$,{onClick:()=>d("font.curve",{amount:20}),children:"Add Curve"})})]})]})})}function ep(e){var t,a,r,i,o;let{layer:l}=e,{project:c,setProject:d,setProjectLive:x,commitHistory:f,toggleCropMode:g,toast:v}=(0,h.h)(),[b,N]=(0,n.useState)("object"!=typeof l.shape.borderRadius),I=c.croppingLayerId===l.id,L=!1!==l.shape.isClosed,[T,R]=(0,n.useState)(null);(0,n.useEffect)(()=>{N("object"!=typeof l.shape.borderRadius)},[l.id,l.shape.borderRadius]);let P=(e,t)=>{d(a=>({...a,layers:a.layers.map(a=>a.id===l.id?ec(a,e,t):a)}))},J=(e,t)=>{T||R(c),x(a=>({...a,layers:a.layers.map(a=>a.id===l.id?ec(a,e,t):a)}))},$=()=>{T&&(f(T,c),R(null))},F=()=>{T||R(c)},X=async e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];if(a)try{let{src:e,width:t,height:s}=await (0,eo.Y)(a);P("shape.fillImage",{src:e,fit:"cover",pan:{x:50,y:50},scale:1,originalWidth:t,originalHeight:s})}catch(e){console.error(e),v({variant:"destructive",title:"Image Upload Failed",description:"Could not process the image."})}};return(0,s.jsx)("div",{className:"space-y-4",children:(0,s.jsxs)(M,{type:"multiple",defaultValue:["transform","fill"],className:"w-full",children:[(0,s.jsxs)(z,{value:"transform",children:[(0,s.jsx)(A,{className:"text-sm font-medium",children:"Transform"}),(0,s.jsx)(S,{children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"X"}),(0,s.jsx)(ed,{value:Math.round(l.transform.x),onChange:e=>J("transform.x",e),onCommit:$})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Y"}),(0,s.jsx)(ed,{value:Math.round(l.transform.y),onChange:e=>J("transform.y",e),onCommit:$})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Width"}),(0,s.jsx)(ed,{value:Math.round(l.transform.width),onChange:e=>J("transform.width",Math.max(10,e)),onCommit:$})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Height"}),(0,s.jsx)(ed,{value:Math.round(l.transform.height),onChange:e=>J("transform.height",Math.max(10,e)),onCommit:$})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Rotation"}),(0,s.jsx)(ed,{value:Math.round(l.transform.rotation),onChange:e=>J("transform.rotation",e),onCommit:$})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(u.J,{children:["Opacity: ",Math.round(100*l.transform.opacity),"%"]}),(0,s.jsx)("div",{onMouseDown:F,onMouseUp:$,children:(0,s.jsx)(E,{value:[l.transform.opacity],onValueChange:e=>{let[t]=e;return J("transform.opacity",t)},min:0,max:1,step:.01})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(u.J,{children:["Blur: ",Math.round(l.transform.blur||0),"px"]}),(0,s.jsx)("div",{onMouseDown:F,onMouseUp:$,children:(0,s.jsx)(E,{value:[l.transform.blur||0],onValueChange:e=>{let[t]=e;return J("transform.blur",t)},min:0,max:100,step:1})})]})]})})]}),L&&(0,s.jsxs)(z,{value:"fill",children:[(0,s.jsx)(A,{className:"text-sm font-medium",children:"Fill"}),(0,s.jsxs)(S,{children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u.J,{children:"Color"}),(0,s.jsx)(eh,{color:l.shape.fill,onChange:e=>P("shape.fill",e),enableTransparent:!0})]}),(0,s.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,s.jsx)(u.J,{children:"Image Fill"}),(0,s.jsx)(p.p,{type:"file",accept:"image/*",onChange:X,className:"text-xs"}),l.shape.fillImage?(0,s.jsxs)("div",{className:"space-y-4 pt-2",children:[(0,s.jsx)(m,{defaultValue:l.shape.fillImage.src,onBlur:e=>{let t=e.target.value;if(!t)return;let a=new window.Image;a.onload=()=>{P("shape.fillImage",{...l.shape.fillImage,src:t,originalWidth:a.width,originalHeight:a.height})},a.onerror=()=>{P("shape.fillImage.src",t),console.warn("Could not load image to get dimensions for URL:",t)},a.src=t},placeholder:"Image URL",className:"text-xs h-20"}),(0,s.jsxs)(D.$,{onClick:()=>g(l.id),variant:I?"secondary":"outline",className:"w-full",children:[(0,s.jsx)(O.A,{className:"mr-2 h-4 w-4"}),I?"Done Adjusting":"Adjust Fill"]}),(0,s.jsxs)(y,{value:l.shape.fillImage.fit,onValueChange:e=>P("shape.fillImage.fit",e),children:[(0,s.jsx)(w,{children:(0,s.jsx)(j,{})}),(0,s.jsxs)(C,{children:[(0,s.jsx)(k,{value:"cover",children:"Cover"}),(0,s.jsx)(k,{value:"contain",children:"Contain"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(u.J,{children:["Zoom: ",Math.round(100*(l.shape.fillImage.scale||1)),"%"]}),(0,s.jsx)("div",{onMouseDown:F,onMouseUp:$,children:(0,s.jsx)(E,{value:[l.shape.fillImage.scale||1],onValueChange:e=>{let[t]=e;return J("shape.fillImage.scale",t)},min:1,max:5,step:.01})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u.J,{children:"Pan"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",onMouseDown:F,onMouseUp:$,children:[(0,s.jsxs)(u.J,{className:"w-12 text-xs",children:["X: ",Math.round(l.shape.fillImage.pan.x),"%"]}),(0,s.jsx)(E,{value:[l.shape.fillImage.pan.x],onValueChange:e=>{let[t]=e;return J("shape.fillImage.pan.x",t)},min:0,max:100,step:1})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",onMouseDown:F,onMouseUp:$,children:[(0,s.jsxs)(u.J,{className:"w-12 text-xs",children:["Y: ",Math.round(l.shape.fillImage.pan.y),"%"]}),(0,s.jsx)(E,{value:[l.shape.fillImage.pan.y],onValueChange:e=>{let[t]=e;return J("shape.fillImage.pan.y",t)},min:0,max:100,step:1})]})]}),(0,s.jsx)(D.$,{variant:"outline",size:"sm",onClick:()=>P("shape.fillImage",null),children:"Remove Image"})]}):(0,s.jsx)("div",{className:"text-xs text-muted-foreground pt-2",children:"Upload an image to use as a fill."})]})]})]}),(0,s.jsxs)(z,{value:"stroke",children:[(0,s.jsx)(A,{className:"text-sm font-medium",children:"Outline"}),(0,s.jsx)(S,{children:l.shape.stroke?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u.J,{children:"Color"}),(0,s.jsx)(eh,{color:l.shape.stroke.color,onChange:e=>P("shape.stroke.color",e)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Width"}),(0,s.jsx)("div",{onMouseDown:F,onMouseUp:$,children:(0,s.jsx)(E,{value:[l.shape.stroke.width],onValueChange:e=>{let[t]=e;return J("shape.stroke.width",t)},min:0,max:50,step:1})})]}),(0,s.jsx)(D.$,{variant:"outline",size:"sm",onClick:()=>P("shape.stroke",null),children:"Remove Outline"})]}):(0,s.jsx)(D.$,{onClick:()=>P("shape.stroke",{color:{type:"solid",mode:"mapped",value:"primary"},width:2}),children:"Add Outline"})})]}),(0,s.jsxs)(z,{value:"shadow",children:[(0,s.jsx)(A,{className:"text-sm font-medium",children:"Shadow"}),(0,s.jsx)(S,{children:l.shape.shadow?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(p.p,{type:"color",value:l.shape.shadow.color,onChange:e=>P("shape.shadow.color",e.target.value),className:"w-10 h-10 p-1"}),(0,s.jsx)(p.p,{value:l.shape.shadow.color,onChange:e=>P("shape.shadow.color",e.target.value)})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(u.J,{children:["Blur: ",l.shape.shadow.blur,"px"]}),(0,s.jsx)("div",{onMouseDown:F,onMouseUp:$,children:(0,s.jsx)(E,{value:[l.shape.shadow.blur],onValueChange:e=>{let[t]=e;return J("shape.shadow.blur",t)},min:0,max:50,step:1})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Offset X"}),(0,s.jsx)(ed,{value:l.shape.shadow.offsetX,onChange:e=>J("shape.shadow.offsetX",e),onCommit:$})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Offset Y"}),(0,s.jsx)(ed,{value:l.shape.shadow.offsetY,onChange:e=>J("shape.shadow.offsetY",e),onCommit:$})]})]}),(0,s.jsx)(D.$,{variant:"outline",size:"sm",onClick:()=>P("shape.shadow",null),children:"Remove Shadow"})]}):(0,s.jsx)(D.$,{onClick:()=>P("shape.shadow",{color:"#00000080",blur:10,offsetX:5,offsetY:5}),children:"Add Shadow"})})]}),"rect"===l.shape.primitive&&(0,s.jsxs)(z,{value:"corners",children:[(0,s.jsx)(A,{className:"text-sm font-medium",children:"Corners"}),(0,s.jsxs)(S,{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)(u.J,{children:"Border Radius"}),(0,s.jsx)(D.$,{variant:"ghost",size:"icon",onClick:()=>{if(b){let e=l.shape.borderRadius||0;P("shape.borderRadius",{tl:e,tr:e,br:e,bl:e})}else P("shape.borderRadius",l.shape.borderRadius.tl||0);N(!b)},className:"h-8 w-8",children:b?(0,s.jsx)(Y.A,{className:"h-4 w-4"}):(0,s.jsx)(U.A,{className:"h-4 w-4"})})]}),b?(0,s.jsx)("div",{onMouseDown:F,onMouseUp:$,children:(0,s.jsx)(E,{value:["number"==typeof l.shape.borderRadius?l.shape.borderRadius:(null==(t=l.shape.borderRadius)?void 0:t.tl)||0],onValueChange:e=>{let[t]=e;return J("shape.borderRadius",t)},min:0,max:Math.min(l.transform.width,l.transform.height)/2,step:1})}):(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)(u.J,{className:"text-xs",children:"Top Left"}),(0,s.jsx)(ed,{value:(null==(a=l.shape.borderRadius)?void 0:a.tl)||0,onChange:e=>J("shape.borderRadius.tl",Math.max(0,e)),onCommit:$})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)(u.J,{className:"text-xs",children:"Top Right"}),(0,s.jsx)(ed,{value:(null==(r=l.shape.borderRadius)?void 0:r.tr)||0,onChange:e=>J("shape.borderRadius.tr",Math.max(0,e)),onCommit:$})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)(u.J,{className:"text-xs",children:"Bottom Left"}),(0,s.jsx)(ed,{value:(null==(i=l.shape.borderRadius)?void 0:i.bl)||0,onChange:e=>J("shape.borderRadius.bl",Math.max(0,e)),onCommit:$})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)(u.J,{className:"text-xs",children:"Bottom Right"}),(0,s.jsx)(ed,{value:(null==(o=l.shape.borderRadius)?void 0:o.br)||0,onChange:e=>J("shape.borderRadius.br",Math.max(0,e)),onCommit:$})]})]})]})]})]})})}function em(e){let{layer:t}=e,{project:a,setProject:r,setProjectLive:i,commitHistory:o,toggleCropMode:l,eyedropper:c,activateEyedropper:d,finishEyedropper:x}=(0,h.h)(),f=a.croppingLayerId===t.id,g=(0,n.useId)(),v=(null==c?void 0:c.isActive)&&c.id===g,[b,N]=(0,n.useState)(null),I=(e,a)=>{r(s=>({...s,layers:s.layers.map(s=>s.id===t.id?ec(s,e,a):s)}))},L=(e,s)=>{b||N(a),i(a=>({...a,layers:a.layers.map(a=>a.id===t.id?ec(a,e,s):a)}))},T=()=>{b&&(o(b,a),N(null))},P=()=>{b||N(a)},J=v&&c.previewColor?c.previewColor:t.chromaKey.color;return(0,s.jsx)("div",{className:"space-y-4",children:(0,s.jsxs)(M,{type:"multiple",defaultValue:["source","transform"],className:"w-full",children:[(0,s.jsxs)(z,{value:"source",children:[(0,s.jsx)(A,{className:"text-sm font-medium",children:"Image"}),(0,s.jsx)(S,{children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)(D.$,{onClick:()=>l(t.id),variant:f?"secondary":"outline",className:"w-full",children:[(0,s.jsx)(O.A,{className:"mr-2 h-4 w-4"}),f?"Done Cropping":"Crop Image"]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Source URL"}),(0,s.jsx)(m,{value:t.src,onChange:e=>I("src",e.target.value),className:"mt-1 h-24",placeholder:"https://..."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Fit"}),(0,s.jsxs)(y,{value:t.fit,onValueChange:e=>I("fit",e),children:[(0,s.jsx)(w,{children:(0,s.jsx)(j,{placeholder:"Image fit"})}),(0,s.jsxs)(C,{children:[(0,s.jsx)(k,{value:"cover",children:"Cover"}),(0,s.jsx)(k,{value:"contain",children:"Contain"})]})]})]}),"cover"===t.fit&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u.J,{children:"Position"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",onMouseDown:P,onMouseUp:T,children:[(0,s.jsxs)(u.J,{className:"w-12 text-xs",children:["X: ",Math.round(t.pan.x),"%"]}),(0,s.jsx)(E,{value:[t.pan.x],onValueChange:e=>{let[t]=e;return L("pan.x",t)},min:0,max:100,step:1})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",onMouseDown:P,onMouseUp:T,children:[(0,s.jsxs)(u.J,{className:"w-12 text-xs",children:["Y: ",Math.round(t.pan.y),"%"]}),(0,s.jsx)(E,{value:[t.pan.y],onValueChange:e=>{let[t]=e;return L("pan.y",t)},min:0,max:100,step:1})]})]})]})]})})]}),(0,s.jsxs)(z,{value:"transform",children:[(0,s.jsx)(A,{className:"text-sm font-medium",children:"Transform"}),(0,s.jsx)(S,{children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"X"}),(0,s.jsx)(ed,{value:Math.round(t.transform.x),onChange:e=>L("transform.x",e),onCommit:T})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Y"}),(0,s.jsx)(ed,{value:Math.round(t.transform.y),onChange:e=>L("transform.y",e),onCommit:T})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Width"}),(0,s.jsx)(ed,{value:Math.round(t.transform.width),onChange:e=>L("transform.width",Math.max(10,e)),onCommit:T})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Height"}),(0,s.jsx)(ed,{value:Math.round(t.transform.height),onChange:e=>L("transform.height",Math.max(10,e)),onCommit:T})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Rotation"}),(0,s.jsx)(ed,{value:Math.round(t.transform.rotation),onChange:e=>L("transform.rotation",e),onCommit:T})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(u.J,{children:["Opacity: ",Math.round(100*t.transform.opacity),"%"]}),(0,s.jsx)("div",{onMouseDown:P,onMouseUp:T,children:(0,s.jsx)(E,{value:[t.transform.opacity],onValueChange:e=>{let[t]=e;return L("transform.opacity",t)},min:0,max:1,step:.01})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(u.J,{children:["Blur: ",Math.round(t.transform.blur||0),"px"]}),(0,s.jsx)("div",{onMouseDown:P,onMouseUp:T,children:(0,s.jsx)(E,{value:[t.transform.blur||0],onValueChange:e=>{let[t]=e;return L("transform.blur",t)},min:0,max:100,step:1})})]})]})})]}),(0,s.jsxs)(z,{value:"shadow",children:[(0,s.jsx)(A,{className:"text-sm font-medium",children:"Shadow"}),(0,s.jsx)(S,{children:t.shadow?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(p.p,{type:"color",value:t.shadow.color,onChange:e=>I("shadow.color",e.target.value),className:"w-10 h-10 p-1"}),(0,s.jsx)(p.p,{value:t.shadow.color,onChange:e=>I("shadow.color",e.target.value)})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(u.J,{children:["Blur: ",t.shadow.blur,"px"]}),(0,s.jsx)("div",{onMouseDown:P,onMouseUp:T,children:(0,s.jsx)(E,{value:[t.shadow.blur],onValueChange:e=>{let[t]=e;return L("shadow.blur",t)},min:0,max:50,step:1})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Offset X"}),(0,s.jsx)(ed,{value:t.shadow.offsetX,onChange:e=>L("shadow.offsetX",e),onCommit:T})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Offset Y"}),(0,s.jsx)(ed,{value:t.shadow.offsetY,onChange:e=>L("shadow.offsetY",e),onCommit:T})]})]}),(0,s.jsx)(D.$,{variant:"outline",size:"sm",onClick:()=>I("shadow",null),children:"Remove Shadow"})]}):(0,s.jsx)(D.$,{onClick:()=>I("shadow",{color:"#00000080",blur:10,offsetX:5,offsetY:5}),children:"Add Shadow"})})]}),(0,s.jsxs)(z,{value:"chroma",children:[(0,s.jsx)(A,{className:"text-sm font-medium",children:"Chroma Key"}),(0,s.jsx)(S,{children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between rounded-lg border p-3 shadow-sm",children:[(0,s.jsx)(u.J,{htmlFor:"chroma-enabled",className:"cursor-pointer",children:"Enable"}),(0,s.jsx)(_,{id:"chroma-enabled",checked:t.chromaKey.enabled,onCheckedChange:e=>I("chromaKey.enabled",e)})]}),t.chromaKey.enabled&&(0,s.jsxs)("div",{className:"space-y-4 pt-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Key Color"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(p.p,{type:"color",value:J,onChange:e=>I("chromaKey.color",e.target.value),className:"w-10 h-10 p-1"}),(0,s.jsx)(p.p,{value:J,onChange:e=>I("chromaKey.color",e.target.value)}),(0,s.jsx)(D.$,{variant:v?"secondary":"outline",size:"icon",className:"h-10 w-10",onClick:()=>{if(v)return void x(null);d(g,e=>{e&&I("chromaKey.color",e)})},children:(0,s.jsx)(R.A,{className:"h-5 w-5"})})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(u.J,{children:["Tolerance: ",Math.round(100*t.chromaKey.tolerance),"%"]}),(0,s.jsx)("div",{onMouseDown:P,onMouseUp:T,children:(0,s.jsx)(E,{value:[t.chromaKey.tolerance],onValueChange:e=>{let[t]=e;return L("chromaKey.tolerance",t)},min:0,max:1,step:.01})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(u.J,{children:["Feather: ",Math.round(100*t.chromaKey.feather),"%"]}),(0,s.jsx)("div",{onMouseDown:P,onMouseUp:T,children:(0,s.jsx)(E,{value:[t.chromaKey.feather],onValueChange:e=>{let[t]=e;return L("chromaKey.feather",t)},min:0,max:1,step:.01})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between rounded-lg border p-3 shadow-sm",children:[(0,s.jsx)(u.J,{htmlFor:"chroma-invert",className:"cursor-pointer",children:"Invert"}),(0,s.jsx)(_,{id:"chroma-invert",checked:t.chromaKey.invert,onCheckedChange:e=>I("chromaKey.invert",e)})]})]})]})})]})]})})}function ex(){let{project:e,setProject:t,addGuide:a,updateGuide:r,removeGuide:o,generateGuides:l,eyedropper:c,activateEyedropper:d,finishEyedropper:m}=(0,h.h)(),[x,f]=(0,n.useState)(4),[g,v]=(0,n.useState)(4),y=(0,n.useId)(),j=(0,n.useId)(),w=(0,n.useId)(),b=(e,a)=>{t(t=>({...t,meta:{...t.meta,[e]:a}}))},N=(e,a)=>{t(t=>({...t,colors:{...t.colors,[e]:a}}))},C=(e,a)=>{t(t=>({...t,canvas:{...t.canvas,[e]:a}}))},k=(e,a)=>{t(t=>({...t,canvas:{...t.canvas,guides:{...t.canvas.guides,[e]:a}}}))},I=(e,t)=>{if((null==c?void 0:c.isActive)&&c.id===e)return void m(null);d(e,e=>{e&&t(e)})},L=e.canvas.guides.items.filter(e=>"horizontal"===e.orientation),E=e.canvas.guides.items.filter(e=>"vertical"===e.orientation),P=(null==c?void 0:c.isActive)&&c.id===y,J=(null==c?void 0:c.isActive)&&c.id===j,$=(null==c?void 0:c.isActive)&&c.id===w;return(0,s.jsx)("div",{className:"space-y-4",children:(0,s.jsxs)(M,{type:"multiple",defaultValue:["meta","canvas","guides","colors"],className:"w-full",children:[(0,s.jsxs)(z,{value:"meta",children:[(0,s.jsx)(A,{className:"text-sm font-medium",children:"Project Info"}),(0,s.jsx)(S,{children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Project Name"}),(0,s.jsx)(p.p,{value:e.meta.name,onChange:e=>b("name",e.target.value)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Category"}),(0,s.jsx)(p.p,{value:e.meta.category,onChange:e=>b("category",e.target.value)})]})]})})]}),(0,s.jsxs)(z,{value:"canvas",children:[(0,s.jsx)(A,{className:"text-sm font-medium",children:"Canvas"}),(0,s.jsx)(S,{children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Width"}),(0,s.jsx)(ed,{value:e.canvas.width,onChange:e=>C("width",Math.max(1,e))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Height"}),(0,s.jsx)(ed,{value:e.canvas.height,onChange:e=>C("height",Math.max(1,e))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Background"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(V,{children:[(0,s.jsx)(B,{asChild:!0,children:(0,s.jsx)(D.$,{variant:"outline",className:"h-10 w-10 p-0 border",children:(0,s.jsx)("div",{className:(0,i.cn)("w-full h-full rounded-sm","transparent"===e.canvas.background&&"checkerboard"),style:{backgroundColor:"transparent"===e.canvas.background?void 0:e.canvas.background}})})}),(0,s.jsx)(K,{className:"w-auto p-0",children:(0,s.jsx)(p.p,{type:"color",value:"transparent"===e.canvas.background?"#ffffff":e.canvas.background,onChange:e=>C("background",e.target.value),className:"w-24 h-24 p-1"})})]}),(0,s.jsx)(p.p,{value:e.canvas.background,onChange:e=>C("background",e.target.value)})]}),(0,s.jsxs)("div",{className:"mt-2 grid grid-cols-2 gap-2",children:[(0,s.jsxs)(D.$,{variant:"outline",size:"sm",onClick:()=>C("background",e.colors.primary),className:"justify-start gap-2",children:[(0,s.jsx)("div",{className:"w-4 h-4 rounded-sm border",style:{backgroundColor:e.colors.primary}}),"Primary"]}),(0,s.jsxs)(D.$,{variant:"outline",size:"sm",onClick:()=>C("background",e.colors.secondary),className:"justify-start gap-2",children:[(0,s.jsx)("div",{className:"w-4 h-4 rounded-sm border",style:{backgroundColor:e.colors.secondary}}),"Secondary"]}),(0,s.jsxs)(D.$,{variant:"outline",size:"sm",onClick:()=>C("background",e.colors.accent),className:"justify-start gap-2",children:[(0,s.jsx)("div",{className:"w-4 h-4 rounded-sm border",style:{backgroundColor:e.colors.accent}}),"Accent"]}),(0,s.jsxs)(D.$,{variant:"outline",size:"sm",onClick:()=>C("background","transparent"),className:"justify-start gap-2",children:[(0,s.jsx)("div",{className:"w-4 h-4 rounded-sm border checkerboard"}),"Transparent"]})]})]})]})})]}),(0,s.jsxs)(z,{value:"guides",children:[(0,s.jsx)(A,{className:"text-sm font-medium",children:"Guides & Snapping"}),(0,s.jsx)(S,{children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between rounded-lg border p-3 shadow-sm",children:[(0,s.jsx)(u.J,{htmlFor:"guides-enabled",className:"cursor-pointer",children:"Enable Guides"}),(0,s.jsx)(_,{id:"guides-enabled",checked:e.canvas.guides.enabled,onCheckedChange:e=>k("enabled",e)})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between rounded-lg border p-3 shadow-sm",children:[(0,s.jsx)(u.J,{htmlFor:"guides-snap",className:"cursor-pointer",children:"Snap to Guides"}),(0,s.jsx)(_,{id:"guides-snap",checked:e.canvas.guides.snap,onCheckedChange:e=>k("snap",e)})]}),(0,s.jsxs)("div",{className:"space-y-2 pt-4",children:[(0,s.jsx)(u.J,{children:"Generate Grid"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(ed,{value:x,onChange:f}),(0,s.jsx)(D.$,{size:"sm",className:"flex-1",onClick:()=>l("horizontal",x),children:"Horizontal"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(ed,{value:g,onChange:v}),(0,s.jsx)(D.$,{size:"sm",className:"flex-1",onClick:()=>l("vertical",g),children:"Vertical"})]})]}),(0,s.jsxs)("div",{className:"relative py-4",children:[(0,s.jsx)("div",{className:"absolute inset-0 flex items-center","aria-hidden":"true",children:(0,s.jsx)("div",{className:"w-full border-t border-border"})}),(0,s.jsx)("div",{className:"relative flex justify-center",children:(0,s.jsx)("span",{className:"bg-card px-2 text-xs text-muted-foreground",children:"OR"})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)(u.J,{children:"Horizontal Guides"}),(0,s.jsx)(D.$,{size:"sm",onClick:()=>a("horizontal"),children:"Add"})]}),(0,s.jsx)("div",{className:"space-y-2 rounded-md border p-2 max-h-40 overflow-y-auto",children:L.map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(ed,{value:Math.round(e.position),onChange:t=>r(e.id,t)}),(0,s.jsx)(D.$,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>o(e.id),children:(0,s.jsx)(T.A,{className:"h-4 w-4 text-destructive"})})]},e.id))})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)(u.J,{children:"Vertical Guides"}),(0,s.jsx)(D.$,{size:"sm",onClick:()=>a("vertical"),children:"Add"})]}),(0,s.jsx)("div",{className:"space-y-2 rounded-md border p-2 max-h-40 overflow-y-auto",children:E.map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(ed,{value:Math.round(e.position),onChange:t=>r(e.id,t)}),(0,s.jsx)(D.$,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>o(e.id),children:(0,s.jsx)(T.A,{className:"h-4 w-4 text-destructive"})})]},e.id))})]})]})})]}),(0,s.jsxs)(z,{value:"colors",children:[(0,s.jsx)(A,{className:"text-sm font-medium",children:"Theme Colors"}),(0,s.jsx)(S,{children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Primary"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(V,{children:[(0,s.jsx)(B,{asChild:!0,children:(0,s.jsx)(D.$,{variant:"outline",className:"h-10 w-10 p-0 border",children:(0,s.jsx)("div",{className:"w-full h-full rounded-sm",style:{backgroundColor:e.colors.primary}})})}),(0,s.jsx)(K,{className:"w-auto p-0",children:(0,s.jsx)(p.p,{type:"color",value:e.colors.primary,onChange:e=>N("primary",e.target.value),className:"w-24 h-24 p-1"})})]}),(0,s.jsx)(p.p,{value:e.colors.primary,onChange:e=>N("primary",e.target.value)}),(0,s.jsx)(D.$,{variant:P?"secondary":"outline",size:"icon",className:"h-10 w-10",onClick:()=>I(y,e=>N("primary",e)),children:(0,s.jsx)(R.A,{className:"h-5 w-5"})})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Secondary"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(V,{children:[(0,s.jsx)(B,{asChild:!0,children:(0,s.jsx)(D.$,{variant:"outline",className:"h-10 w-10 p-0 border",children:(0,s.jsx)("div",{className:"w-full h-full rounded-sm",style:{backgroundColor:e.colors.secondary}})})}),(0,s.jsx)(K,{className:"w-auto p-0",children:(0,s.jsx)(p.p,{type:"color",value:e.colors.secondary,onChange:e=>N("secondary",e.target.value),className:"w-24 h-24 p-1"})})]}),(0,s.jsx)(p.p,{value:e.colors.secondary,onChange:e=>N("secondary",e.target.value)}),(0,s.jsx)(D.$,{variant:J?"secondary":"outline",size:"icon",className:"h-10 w-10",onClick:()=>I(j,e=>N("secondary",e)),children:(0,s.jsx)(R.A,{className:"h-5 w-5"})})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{children:"Accent"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(V,{children:[(0,s.jsx)(B,{asChild:!0,children:(0,s.jsx)(D.$,{variant:"outline",className:"h-10 w-10 p-0 border",children:(0,s.jsx)("div",{className:"w-full h-full rounded-sm",style:{backgroundColor:e.colors.accent}})})}),(0,s.jsx)(K,{className:"w-auto p-0",children:(0,s.jsx)(p.p,{type:"color",value:e.colors.accent,onChange:e=>N("accent",e.target.value),className:"w-24 h-24 p-1"})})]}),(0,s.jsx)(p.p,{value:e.colors.accent,onChange:e=>N("accent",e.target.value)}),(0,s.jsx)(D.$,{variant:$?"secondary":"outline",size:"icon",className:"h-10 w-10",onClick:()=>I(w,e=>N("accent",e)),children:(0,s.jsx)(R.A,{className:"h-5 w-5"})})]})]})]})})]})]})})}function ef(){let{project:e}=(0,h.h)(),{selectedLayers:t}=e;if(0===t.length)return(0,s.jsx)(ex,{});let a=e.layers.find(e=>e.id===t[0]);return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(ei,{}),t.length>1?(0,s.jsxs)("div",{className:"text-center text-muted-foreground text-sm pt-10",children:[(0,s.jsxs)("p",{children:[t.length," layers selected"]}),(0,s.jsx)("p",{className:"mt-2 text-xs",children:"Bulk property editing is not yet supported."})]}):a&&(e=>{switch(e.type){case"text":return(0,s.jsx)(eu,{layer:e});case"shape":return(0,s.jsx)(ep,{layer:e});case"image":return(0,s.jsx)(em,{layer:e});default:return(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Properties for ",null==e?void 0:e.type," layers will be shown here."]})}})(a)]})}var eg=a(4170),ev=a(3775),ey=a(2674),ej=a(3923),ew=a(9803),eb=a(2377),eN=a(7190),eC=a(7048),ek=a(9079);function eI(){let{project:e,setSelectedLayers:t,updateLayer:a,deleteLayers:r,groupLayers:o,ungroupLayers:l,updateGroup:c,deleteGroup:d,addNewGroup:u,handleLayerDrop:m,duplicateLayers:x,moveLayer:g}=(0,h.h)(),[v,y]=(0,n.useState)(null),[j,w]=(0,n.useState)(""),[b,N]=(0,n.useState)(null),[C,k]=(0,n.useState)(null),A=(0,n.useRef)(null),L=(a,s,n)=>{if(v!==s){if("group"===n){let a=e.groups.find(e=>e.id===s);a&&t(a.layerIds);return}if(a.shiftKey){let a=e.selectedLayers;a.includes(s)?t(a.filter(e=>e!==s)):t([...a,s])}else t([s])}},E=e=>{y(e.id),w(e.name)},R=()=>{v&&j.trim()&&(e.groups.some(e=>e.id===v)?c(v,{name:j.trim()}):a(v,{name:j.trim()})),y(null),w("")},P=[...e.layers].sort((e,t)=>t.zIndex-e.zIndex),J=(e,t)=>{if(e.preventDefault(),e.stopPropagation(),!b||b.id===t)return void k(null);let a=e.currentTarget.getBoundingClientRect();k({targetId:t,position:e.clientY-a.top<a.height/2?"before":"after"})},$=new Set(e.groups.flatMap(e=>e.layerIds)),F=P.filter(e=>!$.has(e.id)),O=function(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=e.selectedLayers.includes(t.id),l=(null==b?void 0:b.id)===t.id,c=(null==C?void 0:C.targetId)===t.id&&"inside"!==C.position;return(0,s.jsxs)("li",{"data-id":t.id,draggable:!0,onDragStart:e=>{var a;return a=t.id,void(e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",a),N({id:a,type:"layer"}))},onDragOver:e=>J(e,t.id),className:(0,i.cn)("relative flex items-center justify-between p-2 rounded-md hover:bg-accent/20 cursor-pointer",n&&"ml-4",o&&"bg-accent/10",l&&"opacity-50"),onClick:e=>L(e,t.id,"layer"),children:[c&&(0,s.jsx)("div",{className:(0,i.cn)("absolute left-0 right-0 h-0.5 bg-ring","before"===C.position?"-top-px":"-bottom-px")}),v===t.id?(0,s.jsx)(p.p,{value:j,onChange:e=>w(e.target.value),onBlur:R,onKeyDown:e=>{"Enter"===e.key&&R(),"Escape"===e.key&&(y(null),w(""))},onClick:e=>e.stopPropagation(),autoFocus:!0,className:"h-7 text-sm"}):(0,s.jsxs)("span",{className:"text-sm truncate flex items-center gap-2",onDoubleClick:()=>E(t),children:[(0,s.jsx)(eg.A,{className:"h-4 w-4 cursor-pointer",onClick:e=>{e.stopPropagation(),E(t)}}),t.name]}),(0,s.jsxs)("div",{className:"flex items-center gap-1 shrink-0",children:[(0,s.jsx)(D.$,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:e=>{e.stopPropagation(),g(t.id,"up")},children:(0,s.jsx)(ev.A,{className:"h-4 w-4"})}),(0,s.jsx)(D.$,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:e=>{e.stopPropagation(),g(t.id,"down")},children:(0,s.jsx)(ey.A,{className:"h-4 w-4"})}),(0,s.jsx)(D.$,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:e=>{e.stopPropagation(),x([t.id])},children:(0,s.jsx)(en.A,{className:"h-4 w-4"})}),(0,s.jsx)(D.$,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:e=>{e.stopPropagation(),a(t.id,{locked:!t.locked})},children:t.locked?(0,s.jsx)(Y.A,{className:"h-4 w-4"}):(0,s.jsx)(U.A,{className:"h-4 w-4"})}),(0,s.jsx)(D.$,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:e=>{e.stopPropagation(),a(t.id,{visible:!t.visible})},children:t.visible?(0,s.jsx)(ej.A,{className:"h-4 w-4"}):(0,s.jsx)(ew.A,{className:"h-4 w-4"})}),(0,s.jsx)(D.$,{variant:"ghost",size:"icon",className:"h-6 w-6 hover:bg-destructive/20 hover:text-destructive",onClick:e=>{e.stopPropagation(),r([t.id])},children:(0,s.jsx)(T.A,{className:"h-4 w-4"})})]})]},t.id)};if(0===e.layers.length&&e.groups.length<=1)return(0,s.jsxs)("div",{className:"flex flex-col h-full",children:[(0,s.jsxs)("div",{className:"text-center text-muted-foreground text-sm pt-10 flex-1",children:[(0,s.jsx)("p",{children:"No layers yet"}),(0,s.jsx)("p",{className:"mt-2 text-xs",children:"Use the tools to add text, images, or shapes."})]}),(0,s.jsx)("div",{className:"p-2 border-t flex items-center justify-center",children:(0,s.jsxs)(D.$,{variant:"outline",size:"sm",onClick:()=>u("New Group"),children:[(0,s.jsx)(eb.A,{className:"mr-2 h-4 w-4"})," Add Group"]})})]});let X=[...e.groups].sort((e,t)=>e.name.localeCompare(t.name));return(0,s.jsxs)("div",{className:"flex flex-col h-full",ref:A,onDrop:e=>{e.preventDefault(),b&&C&&("root-drop-zone"===C.targetId?m(b.id,null,"after"):m(b.id,C.targetId,C.position)),N(null),k(null)},onDragEnd:()=>{N(null),k(null)},onDragLeave:e=>{e.currentTarget.contains(e.relatedTarget)||k(null)},children:[(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto p-4",children:[(0,s.jsx)(M,{type:"multiple",className:"w-full",defaultValue:e.groups.map(e=>e.id),children:X.map(t=>{let a=P.filter(e=>e.groupId===t.id),n=t.layerIds.length>0&&t.layerIds.every(t=>e.selectedLayers.includes(t)),r=(null==C?void 0:C.targetId)===t.id&&"inside"!==C.position,o=(null==C?void 0:C.targetId)===t.id&&"inside"===C.position;return(0,s.jsxs)(z,{value:t.id,"data-id":t.id,className:"relative border-b group/item",children:[r&&(0,s.jsx)("div",{className:(0,i.cn)("absolute left-0 right-0 h-0.5 bg-ring z-10","before"===C.position?"-top-px":"bottom-[-1px]")}),(0,s.jsxs)(I.Y9,{onDragOver:e=>J(e,t.id),className:(0,i.cn)("flex items-center justify-between w-full px-2 rounded-md","hover:bg-accent/20",n&&"bg-accent/10"),children:[v===t.id?(0,s.jsx)(p.p,{value:j,onChange:e=>w(e.target.value),onBlur:R,onKeyDown:e=>{"Enter"===e.key&&R(),"Escape"===e.key&&(y(null),w(""))},onClick:e=>e.stopPropagation(),autoFocus:!0,className:"h-7 text-sm my-1 flex-1 bg-transparent"}):(0,s.jsxs)(I.l9,{className:"flex-1 flex items-center justify-between py-2 text-sm text-left",onClick:e=>L(e,t.id,"group"),children:[(0,s.jsxs)("span",{className:"text-sm truncate flex items-center gap-2",onDoubleClick:e=>{e.stopPropagation(),E(t)},children:[(0,s.jsx)(eN.A,{className:"h-4 w-4 cursor-pointer",onClick:e=>{e.stopPropagation(),E(t)}}),t.name]}),(0,s.jsx)(f.A,{className:"h-4 w-4 shrink-0 transition-transform duration-200 group-data-[state=open]/item:rotate-180"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1 shrink-0 pl-2",children:[(0,s.jsx)(D.$,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:e=>{e.stopPropagation(),c(t.id,{locked:!t.locked})},children:t.locked?(0,s.jsx)(Y.A,{className:"h-4 w-4"}):(0,s.jsx)(U.A,{className:"h-4 w-4"})}),(0,s.jsx)(D.$,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:e=>{e.stopPropagation(),c(t.id,{visible:!t.visible})},children:t.visible?(0,s.jsx)(ej.A,{className:"h-4 w-4"}):(0,s.jsx)(ew.A,{className:"h-4 w-4"})}),"editable-group"!==t.id&&(0,s.jsx)(D.$,{variant:"ghost",size:"icon",className:"h-6 w-6 hover:bg-destructive/20 hover:text-destructive",onClick:e=>{e.stopPropagation(),d(t.id)},children:(0,s.jsx)(T.A,{className:"h-4 w-4"})})]})]}),(0,s.jsx)(S,{onDragOver:e=>((e,t)=>{if(e.preventDefault(),e.stopPropagation(),!b||b.id===t||"group"===b.type)return void k(null);k({targetId:t,position:"inside"})})(e,t.id),children:(0,s.jsx)("ul",{className:(0,i.cn)("space-y-1 p-1 rounded-lg border-2 border-dashed border-transparent transition-colors",o&&"border-ring bg-accent/10"),children:a.length>0?a.map(e=>O(e,!0)):(0,s.jsx)("li",{className:"text-xs text-muted-foreground text-center p-2 h-8 flex items-center justify-center",children:"Drop to add to group"})})})]},t.id)})}),(0,s.jsx)("ul",{className:(0,i.cn)("space-y-1 mt-2 p-1 rounded-lg border-2 border-dashed border-transparent transition-colors min-h-[40px]",(null==C?void 0:C.targetId)==="root-drop-zone"&&"border-ring bg-accent/10"),onDragOver:e=>{e.preventDefault(),e.stopPropagation(),(null==b?void 0:b.type)==="layer"&&k({targetId:"root-drop-zone",position:"inside"})},children:F.length>0?F.map(e=>O(e)):(0,s.jsx)("li",{className:"text-xs text-muted-foreground text-center p-2 h-8 flex items-center justify-center pointer-events-none",children:"Drop here to make a root layer"})})]}),(0,s.jsxs)("div",{className:"p-2 border-t flex items-center gap-2",children:[(0,s.jsxs)(D.$,{variant:"outline",size:"sm",onClick:()=>u("New Group"),children:[(0,s.jsx)(eb.A,{className:"mr-2 h-4 w-4"})," Add Group"]}),(0,s.jsxs)(D.$,{variant:"outline",size:"sm",className:"w-full",onClick:()=>{e.selectedLayers.length>1&&o(e.selectedLayers)},disabled:e.selectedLayers.length<2,children:[(0,s.jsx)(eC.A,{className:"mr-2 h-4 w-4"})," Group"]}),(0,s.jsxs)(D.$,{variant:"outline",size:"sm",className:"w-full",onClick:()=>{let t=e.layers.find(t=>e.selectedLayers.includes(t.id));(null==t?void 0:t.groupId)&&l(t.groupId)},disabled:!e.selectedLayers.some(t=>{var a;return null==(a=e.layers.find(e=>e.id===t))?void 0:a.groupId}),children:[(0,s.jsx)(ek.A,{className:"mr-2 h-4 w-4"})," Ungroup"]})]})]})}function eM(){return(0,s.jsx)("aside",{className:"w-80 border-l bg-card flex flex-col",children:(0,s.jsxs)(o,{defaultValue:"properties",className:"h-full flex flex-col",children:[(0,s.jsxs)(l,{className:"grid w-full grid-cols-2 rounded-none border-b",children:[(0,s.jsx)(c,{value:"properties",children:"Properties"}),(0,s.jsx)(c,{value:"layers",children:"Layers"})]}),(0,s.jsx)(d,{value:"properties",className:"flex-1 overflow-y-auto p-4",children:(0,s.jsx)(ef,{})}),(0,s.jsx)(d,{value:"layers",className:"flex-1 overflow-hidden",children:(0,s.jsx)(eI,{})})]})})}},8611:(e,t,a)=>{"use strict";a.d(t,{Bc:()=>o,ZI:()=>d,k$:()=>c,m_:()=>l});var s=a(3424),n=a(3884),r=a(9467),i=a(9257);let o=r.Kq,l=r.bL,c=r.l9,d=n.forwardRef((e,t)=>{let{className:a,sideOffset:n=4,...o}=e;return(0,s.jsx)(r.UC,{ref:t,sideOffset:n,className:(0,i.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...o})});d.displayName=r.UC.displayName},8661:(e,t,a)=>{"use strict";a.d(t,{Tj:()=>i,kq:()=>o,y1:()=>r});let s=JSON.parse('{"Y":["Inter:wght@400;500;600;700","Source+Code+Pro","Roboto:ital,wght@0,400;0,700;1,400;1,700","Lato:ital,wght@0,400;0,700;1,400;1,700","Montserrat:ital,wght@0,400;0,700;1,400;1,700","Oswald:wght@400;700","Playfair+Display:ital,wght@0,400;0,700;1,400;1,700","Lora:ital,wght@0,400;0,700;1,400;1,700"],"y":[{"family":"Coolvetica","variants":[{"weight":400,"style":"normal","url":"/fonts/coolvetica-rg.woff2"}]},{"family":"Garet","variants":[{"weight":700,"style":"normal","url":"/fonts/garet-heavy.woff2"}]}]}'),n=s.Y,r=s.y,i=[...n.map(e=>e.split(":")[0].replace(/\+/g," ")),...r.map(e=>e.family)].sort();function o(){let e=n.map(e=>"family=".concat(e)).join("&");return"https://fonts.googleapis.com/css2?".concat(e,"&display=swap")}},8754:(e,t,a)=>{"use strict";a.d(t,{dj:()=>h});var s=a(3884);let n=0,r=new Map,i=e=>{if(r.has(e))return;let t=setTimeout(()=>{r.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);r.set(e,t)},o=[],l={toasts:[]};function c(e){l=((e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?i(a):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}})(l,e),o.forEach(e=>{e(l)})}function d(e){let{...t}=e,a=(n=(n+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>c({type:"DISMISS_TOAST",toastId:a});return c({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||s()}}}),{id:a,dismiss:s,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function h(){let[e,t]=s.useState(l);return s.useEffect(()=>(o.push(t),()=>{let e=o.indexOf(t);e>-1&&o.splice(e,1)}),[e]),{...e,toast:d,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},9257:(e,t,a)=>{"use strict";a.d(t,{cn:()=>r});var s=a(3312),n=a(1100);function r(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,n.QP)((0,s.$)(t))}},9673:(e,t,a)=>{Promise.resolve().then(a.bind(a,874)),Promise.resolve().then(a.bind(a,7188)),Promise.resolve().then(a.bind(a,8066)),Promise.resolve().then(a.bind(a,3844)),Promise.resolve().then(a.bind(a,6418))},9793:(e,t,a)=>{"use strict";a.d(t,{bP:()=>n,qw:()=>r});var s=a(6447);function n(e){let{shape:t,transform:a}=e,{width:s,height:n}=a;switch(t.primitive){case"rect":let r=t.borderRadius||0;if("number"==typeof r){let e=Math.min(r,s/2,n/2);if(e<=0)return"M 0,0 H ".concat(s," V ").concat(n," H 0 Z");return"M ".concat(e,",0 H ").concat(s-e," A ").concat(e,",").concat(e," 0 0 1 ").concat(s,",").concat(e," V ").concat(n-e," A ").concat(e,",").concat(e," 0 0 1 ").concat(s-e,",").concat(n," H ").concat(e," A ").concat(e,",").concat(e," 0 0 1 0,").concat(n-e," V ").concat(e," A ").concat(e,",").concat(e," 0 0 1 ").concat(e,",0 Z")}let{tl:i,tr:o,br:l,bl:c}=r;return i=Math.max(0,Math.min(i,s/2,n/2)),o=Math.max(0,Math.min(o,s/2,n/2)),l=Math.max(0,Math.min(l,s/2,n/2)),c=Math.max(0,Math.min(c,s/2,n/2)),"M ".concat(i,",0 L ").concat(s-o,",0 A ").concat(o,",").concat(o," 0 0 1 ").concat(s,",").concat(o," V ").concat(n-l," A ").concat(l,",").concat(l," 0 0 1 ").concat(s-l,",").concat(n," L ").concat(c,",").concat(n," A ").concat(c,",").concat(c," 0 0 1 0,").concat(n-c," V ").concat(i," A ").concat(i,",").concat(i," 0 0 1 ").concat(i,",0 Z");case"circle":return"M ".concat(s/2,", 0 A ").concat(s/2,",").concat(n/2," 0 1,1 ").concat(s/2,", ").concat(n," A ").concat(s/2,",").concat(n/2," 0 1,1 ").concat(s/2,", 0 Z");case"heart":return"M50 30 C30 10, 10 30, 10 50 C10 70, 50 90, 50 90 C50 90, 90 70, 90 50 C90 30, 70 10, 50 30 Z".replace(/(\d+(\.\d+)?)/g,(e,t,a)=>(parseFloat(t)*(a%2==0?n/100:s/100)).toString()),"M".concat(.5*s," ").concat(.3*n," C").concat(.3*s," ").concat(.1*n,", ").concat(.1*s," ").concat(.3*n,", ").concat(.1*s," ").concat(.5*n," C").concat(.1*s," ").concat(.7*n,", ").concat(.5*s," ").concat(.9*n,", ").concat(.5*s," ").concat(.9*n," C").concat(.5*s," ").concat(.9*n,", ").concat(.9*s," ").concat(.7*n,", ").concat(.9*s," ").concat(.5*n," C").concat(.9*s," ").concat(.3*n,", ").concat(.7*s," ").concat(.1*n,", ").concat(.5*s," ").concat(.3*n," Z");case"path":var d;return function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(!e||e.length<1)return"";if(e.length<2)return"M ".concat(e[0].x," ").concat(e[0].y);let a=e.map((t,a)=>{if(0===a)return"M ".concat(t.x," ").concat(t.y);let s=e[a-1];return"C ".concat(s.handles.out.x," ").concat(s.handles.out.y,", ").concat(t.handles.in.x," ").concat(t.handles.in.y,", ").concat(t.x," ").concat(t.y)}).join(" ");if(t){let t=e[e.length-1],s=e[0];return"".concat(a," C ").concat(t.handles.out.x," ").concat(t.handles.out.y,", ").concat(s.handles.in.x," ").concat(s.handles.in.y,", ").concat(s.x," ").concat(s.y," Z")}return a}(null==(d=t.points)?void 0:d.map(e=>({...e,x:e.x/100*s,y:e.y/100*n,handles:{in:{x:e.handles.in.x/100*s,y:e.handles.in.y/100*n},out:{x:e.handles.out.x/100*s,y:e.handles.out.y/100*n}}})),t.isClosed);case"line":case"dashed-line":return"M 0,".concat(n/2," L ").concat(s,",").concat(n/2);case"pentagon":case"star":return"M ".concat((e=>{let t="";switch(e){case"pentagon":t="50,0 100,38 81,100 19,100 0,38";break;case"star":t="50,0 61.2,35.2 98.2,35.2 68.5,57 79.7,92.2 50,70 20.3,92.2 31.5,57 1.8,35.2 38.8,35.2";break;default:return""}return t.split(" ").map(e=>{let[t,a]=e.split(",");return"".concat(parseFloat(t)/100*s,",").concat(parseFloat(a)/100*n)}).join(" ")})(t.primitive)," Z")}return""}function r(e){if("path"===e.shape.primitive)return e;switch(e.shape.primitive){case"rect":if("rect"!==e.shape.primitive||e.shape.points)return e;let t=[{id:(0,s.l)(),x:0,y:0,type:"corner",handles:{in:{x:0,y:0},out:{x:0,y:0}}},{id:(0,s.l)(),x:100,y:0,type:"corner",handles:{in:{x:100,y:0},out:{x:100,y:0}}},{id:(0,s.l)(),x:100,y:100,type:"corner",handles:{in:{x:100,y:100},out:{x:100,y:100}}},{id:(0,s.l)(),x:0,y:100,type:"corner",handles:{in:{x:0,y:100},out:{x:0,y:100}}}];return{...e,shape:{...e.shape,primitive:"path",points:t,isClosed:!0}};case"circle":if("circle"!==e.shape.primitive||e.shape.points)return e;let a=[{id:(0,s.l)(),x:50,y:0,type:"curve",handles:{in:{x:22.385762508450004,y:0},out:{x:77.61423749155,y:0}}},{id:(0,s.l)(),x:100,y:50,type:"curve",handles:{in:{x:100,y:22.385762508450004},out:{x:100,y:77.61423749155}}},{id:(0,s.l)(),x:50,y:100,type:"curve",handles:{in:{x:77.61423749155,y:100},out:{x:22.385762508450004,y:100}}},{id:(0,s.l)(),x:0,y:50,type:"curve",handles:{in:{x:0,y:77.61423749155},out:{x:0,y:22.385762508450004}}}];return{...e,shape:{...e.shape,primitive:"path",points:a,isClosed:!0}};case"pentagon":if("pentagon"!==e.shape.primitive||e.shape.points)return e;let n=[{x:50,y:0},{x:100,y:38},{x:81,y:100},{x:19,y:100},{x:0,y:38}].map(e=>({id:(0,s.l)(),x:e.x,y:e.y,type:"corner",handles:{in:{x:e.x,y:e.y},out:{x:e.x,y:e.y}}}));return{...e,shape:{...e.shape,primitive:"path",points:n,isClosed:!0}};case"star":if("star"!==e.shape.primitive||e.shape.points)return e;let r=[{x:50,y:0},{x:61.2,y:35.2},{x:98.2,y:35.2},{x:68.5,y:57},{x:79.7,y:92.2},{x:50,y:70},{x:20.3,y:92.2},{x:31.5,y:57},{x:1.8,y:35.2},{x:38.8,y:35.2}].map(e=>({id:(0,s.l)(),x:e.x,y:e.y,type:"corner",handles:{in:{x:e.x,y:e.y},out:{x:e.x,y:e.y}}}));return{...e,shape:{...e.shape,primitive:"path",points:r,isClosed:!0}};case"heart":if("heart"!==e.shape.primitive||e.shape.points)return e;let i=[{id:(0,s.l)(),x:50,y:30,type:"curve",handles:{in:{x:70,y:10},out:{x:30,y:10}}},{id:(0,s.l)(),x:10,y:50,type:"curve",handles:{in:{x:10,y:30},out:{x:10,y:70}}},{id:(0,s.l)(),x:50,y:90,type:"corner",handles:{in:{x:50,y:90},out:{x:50,y:90}}},{id:(0,s.l)(),x:90,y:50,type:"curve",handles:{in:{x:90,y:70},out:{x:90,y:30}}}];return{...e,shape:{...e.shape,primitive:"path",points:i,isClosed:!0}};case"line":case"dashed-line":if("line"!==e.shape.primitive&&"dashed-line"!==e.shape.primitive||e.shape.points)return e;let o=[{id:(0,s.l)(),x:0,y:50,type:"corner",handles:{in:{x:0,y:50},out:{x:0,y:50}}},{id:(0,s.l)(),x:100,y:50,type:"corner",handles:{in:{x:100,y:50},out:{x:100,y:50}}}];return{...e,shape:{...e.shape,primitive:"path",points:o,isClosed:!1}};default:return e}}}},e=>{e.O(0,[341,655,996,264,304,358],()=>e(e.s=9673)),_N_E=e.O()}]);